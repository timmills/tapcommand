INFO:     Will watch for changes in these directories: ['/home/coastal/smartvenue/backend']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [584697] using WatchFiles
/home/coastal/smartvenue/backend/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [584731]
INFO:     Waiting for application startup.
2025-10-07 14:41:35,206 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 14:41:35,212 - app.main - INFO - Database tables created
2025-10-07 14:41:35,234 - app.main - INFO - Database initialized with seed data
2025-10-07 14:41:35,235 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 14:41:35,236 - app.services.discovery - INFO - Device discovery started
2025-10-07 14:41:35,236 - app.main - INFO - Device discovery started
2025-10-07 14:41:35,236 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 14:41:35,236 - app.main - INFO - Device health monitoring started
2025-10-07 14:41:35,236 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 14:41:35,236 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 14:41:35,236 - app.main - INFO - Command queue processor started
2025-10-07 14:41:35,236 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 14:41:35,236 - app.main - INFO - History cleanup service started
2025-10-07 14:41:35,237 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 14:41:35,238 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 14:41:35,240 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 14:41:35,240 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 14:41:35,240 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 14:41:35,240 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 14:41:35,241 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 14:41:35,241 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 14:41:35,241 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 14:41:35,241 - app.main - INFO - Schedule processor started
2025-10-07 14:41:35,241 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 14:41:35,241 - app.main - INFO - Device status monitoring started
2025-10-07 14:41:35,241 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 14:41:35,241 - app.main - INFO - TV status polling service started
2025-10-07 14:41:35,242 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 14:41:35,246 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 14:41:35,247 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 14:41:35,248 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 12.3 hours)
2025-10-07 14:41:35,255 - app.services.device_status_checker - INFO - Checking status of 3 devices
INFO:     Application startup complete.
Template seeding complete; using dynamic IR library system.
INFO:     100.98.57.42:63104 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     127.0.0.1:35534 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:62061 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:56939 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'app/api/device_management.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 14:42:32,101 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 14:42:32,101 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 14:42:32,101 - app.main - INFO - TV status polling service stopped
2025-10-07 14:42:32,101 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 14:42:32,101 - app.main - INFO - Device status monitoring stopped
2025-10-07 14:42:32,101 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 14:42:32,101 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 14:42:32,101 - app.main - INFO - Schedule processor stopped
2025-10-07 14:42:32,102 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 14:42:32,102 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 14:42:32,102 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 14:42:32,102 - app.main - INFO - History cleanup service stopped
2025-10-07 14:42:32,102 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 14:42:32,102 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 14:42:32,102 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 14:42:32,102 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 14:42:32,102 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 14:42:32,102 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 14:42:32,102 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 14:42:32,102 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 14:42:32,102 - app.main - INFO - Command queue processor stopped
2025-10-07 14:42:32,102 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 14:42:32,102 - app.main - INFO - Device health monitoring stopped
2025-10-07 14:42:32,102 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 14:42:32,102 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 14:42:32,102 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [584731]
/home/coastal/smartvenue/backend/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [584843]
INFO:     Waiting for application startup.
2025-10-07 14:42:33,719 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 14:42:33,724 - app.main - INFO - Database tables created
2025-10-07 14:42:33,745 - app.main - INFO - Database initialized with seed data
2025-10-07 14:42:33,745 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 14:42:33,746 - app.services.discovery - INFO - Device discovery started
2025-10-07 14:42:33,746 - app.main - INFO - Device discovery started
2025-10-07 14:42:33,746 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 14:42:33,746 - app.main - INFO - Device health monitoring started
2025-10-07 14:42:33,746 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 14:42:33,746 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 14:42:33,746 - app.main - INFO - Command queue processor started
2025-10-07 14:42:33,746 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 14:42:33,746 - app.main - INFO - History cleanup service started
2025-10-07 14:42:33,746 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 14:42:33,748 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 14:42:33,749 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 14:42:33,749 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 14:42:33,749 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 14:42:33,749 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 14:42:33,750 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 14:42:33,750 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 14:42:33,750 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 14:42:33,750 - app.main - INFO - Schedule processor started
2025-10-07 14:42:33,750 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 14:42:33,750 - app.main - INFO - Device status monitoring started
2025-10-07 14:42:33,750 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 14:42:33,750 - app.main - INFO - TV status polling service started
2025-10-07 14:42:33,750 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 14:42:33,755 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 14:42:33,755 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 14:42:33,756 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 12.3 hours)
2025-10-07 14:42:33,762 - app.services.device_status_checker - INFO - Checking status of 3 devices
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'app/services/discovery.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 14:43:05,569 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 14:43:05,569 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
202INFO:     Waiting for application shutdown.
2025-10-07 14:43:05,652 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 14:43:05,652 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 14:43:05,652 - app.main - INFO - TV status polling service stopped
2025-10-07 14:43:05,653 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 14:43:05,653 - app.main - INFO - Device status monitoring stopped
2025-10-07 14:43:05,653 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 14:43:05,653 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 14:43:05,653 - app.main - INFO - Schedule processor stopped
2025-10-07 14:43:05,653 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 14:43:05,653 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 14:43:05,653 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 14:43:05,653 - app.main - INFO - History cleanup service stopped
2025-10-07 14:43:05,653 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 14:43:05,653 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 14:43:05,653 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 14:43:05,653 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 14:43:05,653 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 14:43:05,653 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 14:43:05,653 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 14:43:05,653 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 14:43:05,653 - app.main - INFO - Command queue processor stopped
2025-10-07 14:43:05,653 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 14:43:05,653 - app.main - INFO - Device health monitoring stopped
2025-10-07 14:43:05,653 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 14:43:05,654 - app.services.discovery - INFO - Dev/home/coastal/smartvenue/backend/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `/home/coastal/smartvenue/venv/lib/python3.12/site-packages/pyINFO:     Started server process [584885]
INFO:     Waiting for application startup.
2025-10-07 14:43:07,249 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 14:43:07,254 - app.main - INFO - Database tables createdINFO:     Started server process [584887]
INFO:     Waiting for application startup.
2025-10-07 14:43:07,335 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 14:43:07,341 - app.main - INFO - Database tables created
2025-10-07 14:43:07,362 - app.main - INFO - Database initialized with seed data
2025-10-07 14:43:07,362 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 14:43:07,363 - app.services.discovery - INFO - Device discovery started
2025-10-07 14:43:07,363 - app.main - INFO - Device discovery started
2025-10-07 14:43:07,363 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 14:43:07,363 - app.main - INFO - Device health monitoring started
2025-10-07 14:43:07,363 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 14:43:07,363 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 14:43:07,363 - app.main - INFO - Command queue processor started
2025-10-07 14:43:07,363 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 14:43:07,363 - app.main - INFO - History cleanup service started
2025-10-07 14:43:07,363 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 14:43:07,364 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 14:43:07,366 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 14:43:07,366 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 14:43:07,366 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 14:43:07,366 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 14:43:07,367 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 14:43:07,367 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 14:43:07,367 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 14:43:07,367 - app.main - INFO - Schedule processor started
2025-10-07 14:43:07,367 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 14:43:07,367 - app.main - INFO - Device status monitoring started
2025-10-07 14:43:07,367 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 14:43:07,367 - app.main - INFO - TV status polling service started
2025-10-07 14:43:07,367 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 14:43:07,371 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 14:43:07,372 - app.services.queue_processor - INFO - Worker 2 started
2025-10INFO:     Application startup complete.
2025-10-07 14:48:07,283 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 14:48:07,288 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 14:48:09,345 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 14:48:11,417 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 14:48:16,553 - app.services.esphome_client - WARNING - Timed out waiting for capabilities from ir-dcf89f
2025-10-07 14:48:26,553 - aioesphomeapi.connection - ERROR - 192.168.101.146: disconnect request failed: Timeou2025-10-07 14:48:51,510 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: [Errno 104] Connection reset by peer
2025-10-07 14:48:51,510 - app.services.esphome_client - ERROR - Error retrieving capabilities from ir-dcf89f: ReTemplate seeding complete; using dynamic IR library system.
INFO:     100.98.57.42:50685 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:50685 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
IWARNING:  WatchFiles detected changes in 'app/api/device_management.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 14:51:40,287 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 14:51:40,287 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 14:51:40,287 - app.main - INFO - TV status polling service stopped
2025-10-07 14:51:40,287 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 14:51:40,287 - app.main - INFO - Device status monitoring stopped
2025-10-07 14:51:40,287 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 14:51:40,287 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 14:51:40,287 - app.main - INFO - Schedule processor stopped
2025-10-07 14:51:40,287 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 14:51:40,287 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 14:51:40,287 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 14:51:40,288 - app.main - INFO - History cleanup service stopped
2025-10-07 14:51:40,288 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 14:51:40,288 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 14:51:40,288 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 14:51:40,288 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 14:51:40,288 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 14:51:40,288 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 14:51:40,288 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 14:51:40,288 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 14:51:40,288 - app.main - INFO - Command queue processor stopped
2025-10-07 14:51:40,288 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 14:51:40,288 - app.main - INFO - Device health monitoring stopped
2025-10-07 14:51:40,288 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 14:51:40,288 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 14:51:40,288 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [584887]
Template seeding complete; using dynamic IR library system.
/home/coastal/smartvenue/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [585002]
INFO:     Waiting for application startup.
2025-10-07 14:51:41,953 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 14:51:41,958 - app.main - INFO - Database tables created
2025-10-07 14:51:41,979 - app.main - INFO - Database initialized with seed data
2025-10-07 14:51:41,979 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 14:51:41,980 - app.services.discovery - INFO - Device discovery started
2025-10-07 14:51:41,980 - app.main - INFO - Device discovery started
2025-10-07 14:51:41,980 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 14:51:41,980 - app.main - INFO - Device health monitoring started
2025-10-07 14:51:41,980 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 14:51:41,980 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 14:51:41,980 - app.main - INFO - Command queue processor started
2025-10-07 14:51:41,981 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 14:51:41,981 - app.main - INFO - History cleanup service started
2025-10-07 14:51:41,981 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 14:51:41,982 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 14:51:41,983 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 14:51:41,983 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 14:51:41,984 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 14:51:41,984 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 14:51:41,984 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 14:51:41,984 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 14:51:41,984 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 14:51:41,984 - app.main - INFO - Schedule processor started
2025-10-07 14:51:41,984 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 14:51:41,984 - app.main - INFO - Device status monitoring started
2025-10-07 14:51:41,984 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 14:51:41,984 - app.main - INFO - TV status polling service started
2025-10-07 14:51:41,984 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 14:51:41,989 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 14:51:41,989 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 14:51:41,990 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 12.1 hours)
2025-10-07 14:51:41,996 - app.services.device_status_checker - INFO - Checking status of 3 devices
INFO:     Application startup complete.
2025-10-07 14:56:41,985 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 14:56:41,990 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 14:56:44,047 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 14:56:46,118 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 14:57:26,122 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: [Errno 104] Connection reset by peer
2025-10-07 14:57:26,122 - app.services.esphome_client - ERROR - Error retrieving capabilities from ir-dcf89f: Read failed
2025-10-07 14:57:26,122 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 14:57:26,125 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 15:01:46,085 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 15:02:26,126 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 15:02:26,126 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 15:02:28,572 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 15:02:28,766 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 15:02:28,773 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 15:06:48,123 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 15:07:28,774 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 15:07:28,774 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 15:07:31,436 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 15:07:31,637 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 15:07:31,641 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 15:11:50,160 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 15:12:31,641 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 15:12:31,642 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 15:12:34,349 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 15:12:34,556 - aioesphomeapi.connection - ERROR - 192.168.101.146: disconnect request failed: 192.168.101.146: EOF received
2025-10-07 15:12:34,556 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 15:12:34,560 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 15:16:52,213 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 15:17:34,560 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 15:17:34,560 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 15:17:37,227 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 15:17:37,440 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 15:17:37,444 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 15:21:54,252 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 15:22:37,445 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 15:22:37,445 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 15:22:39,939 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 15:22:40,133 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 15:22:40,137 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 15:26:56,290 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 15:27:40,136 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 15:27:40,137 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 15:27:42,803 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 15:27:43,015 - aioesphomeapi.connection - ERROR - 192.168.101.146: disconnect request failed: 192.168.101.146: EOF received
2025-10-07 15:27:43,015 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 15:27:43,019 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 15:31:58,328 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 15:32:43,019 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 15:32:43,020 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 15:32:45,678 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 15:32:45,884 - aioesphomeapi.connection - ERROR - 192.168.101.146: disconnect request failed: 192.168.101.146: EOF received
2025-10-07 15:32:45,884 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 15:32:45,889 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 15:37:00,366 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 15:37:45,888 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 15:37:45,889 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 15:37:49,171 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 15:37:49,389 - aioesphomeapi.connection - ERROR - 192.168.101.146: disconnect request failed: 192.168.101.146: EOF received
2025-10-07 15:37:49,389 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 15:37:49,393 - app.services.device_health - INFO - Health check complete: 1/1 devices online
WARNING:  WatchFiles detected changes in 'app/services/discovery.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 15:40:39,351 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 15:40:39,351 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 15:40:39,351 - app.main - INFO - TV status polling service stopped
2025-10-07 15:40:39,351 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 15:40:39,351 - app.main - INFO - Device status monitoring stopped
2025-10-07 15:40:39,351 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 15:40:39,351 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 15:40:39,351 - app.main - INFO - Schedule processor stopped
2025-10-07 15:40:39,351 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 15:40:39,352 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 15:40:39,352 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 15:40:39,352 - app.main - INFO - History cleanup service stopped
2025-10-07 15:40:39,352 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 15:40:39,352 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 15:40:39,352 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 15:40:39,352 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 15:40:39,352 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 15:40:39,352 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 15:40:39,352 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 15:40:39,352 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 15:40:39,352 - app.main - INFO - Command queue processor stopped
2025-10-07 15:40:39,352 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 15:40:39,352 - app.main - INFO - Device health monitoring stopped
2025-10-07 15:40:39,352 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 15:40:39,352 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 15:40:39,352 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [585002]
Template seeding complete; using dynamic IR library system.
/home/coastal/smartvenue/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [587266]
INFO:     Waiting for application startup.
2025-10-07 15:40:41,043 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 15:40:41,048 - app.main - INFO - Database tables created
2025-10-07 15:40:41,070 - app.main - INFO - Database initialized with seed data
2025-10-07 15:40:41,070 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 15:40:41,071 - app.services.discovery - INFO - Device discovery started
2025-10-07 15:40:41,071 - app.main - INFO - Device discovery started
2025-10-07 15:40:41,071 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 15:40:41,071 - app.main - INFO - Device health monitoring started
2025-10-07 15:40:41,072 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 15:40:41,072 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 15:40:41,072 - app.main - INFO - Command queue processor started
2025-10-07 15:40:41,072 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 15:40:41,072 - app.main - INFO - History cleanup service started
2025-10-07 15:40:41,072 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 15:40:41,073 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 15:40:41,075 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 15:40:41,075 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 15:40:41,075 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 15:40:41,075 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 15:40:41,076 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 15:40:41,076 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 15:40:41,076 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 15:40:41,076 - app.main - INFO - Schedule processor started
2025-10-07 15:40:41,076 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 15:40:41,076 - app.main - INFO - Device status monitoring started
2025-10-07 15:40:41,076 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 15:40:41,076 - app.main - INFO - TV status polling service started
2025-10-07 15:40:41,076 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 15:40:41,081 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 15:40:41,082 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 15:40:41,082 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 11.3 hours)
2025-10-07 15:40:41,088 - app.services.device_status_checker - INFO - Checking status of 3 devices
INFO:     Application startup complete.
2025-10-07 15:40:43,186 - app.services.discovery - INFO - mDNS service discovered: ir._esphomelib._tcp.local.
2025-10-07 15:40:43,187 - app.services.discovery - INFO - Processing mDNS device: ir at 192.168.101.146:6053
2025-10-07 15:40:43,187 - app.services.discovery - INFO - Discovered ESPHome device: ir (192.168.101.146)
2025-10-07 15:40:43,187 - app.main - INFO - New device discovered: ir (192.168.101.146)
2025-10-07 15:40:43,243 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 15:40:43,243 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 15:40:43,243 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 15:40:43,243 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 15:40:43,286 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 15:40:43,286 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 15:40:43,286 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 15:40:43,286 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 15:40:43,310 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 15:40:43,311 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 15:40:43,311 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 15:40:43,311 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 15:40:43,342 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 15:40:43,342 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 15:40:43,342 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 15:40:43,342 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 15:40:43,342 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 15:40:43,343 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 15:40:43,343 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 15:40:43,343 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 15:40:44,198 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 15:40:44,198 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 15:40:44,198 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 15:40:44,198 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 15:40:44,203 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 15:40:44,203 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 15:40:44,203 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 15:40:44,203 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 15:40:44,355 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 15:40:44,356 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 15:40:44,356 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 15:40:44,356 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 15:40:57,388 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 15:40:57,389 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 15:40:57,389 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 15:40:57,389 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 15:40:57,454 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 15:40:57,454 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 15:40:57,455 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 15:40:57,455 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 15:40:57,490 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 15:40:57,491 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 15:40:57,491 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 15:40:57,491 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 15:43:36,435 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 15:43:36,435 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 15:43:36,435 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 15:43:36,435 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 15:45:41,077 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 15:45:41,082 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 15:45:43,140 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 15:45:51,084 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error while finishing connection: Finishing connection cancelled
2025-10-07 15:45:51,084 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dcf89f
2025-10-07 15:45:51,084 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: Connection lost
2025-10-07 15:45:54,146 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 15:45:57,218 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 15:45:58,150 - app.services.discovery - INFO - mDNS service discovered: ir._esphomelib._tcp.local.
2025-10-07 15:45:58,150 - app.services.discovery - INFO - Processing mDNS device: ir at 192.168.101.146:6053
2025-10-07 15:45:58,150 - app.services.discovery - INFO - Discovered ESPHome device: ir (192.168.101.146)
2025-10-07 15:45:58,150 - app.main - INFO - New device discovered: ir (192.168.101.146)
2025-10-07 15:46:00,290 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 15:46:03,362 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 15:46:06,434 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 15:46:09,506 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 15:46:09,568 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 15:46:12,642 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 15:46:15,714 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 15:46:18,786 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 15:46:21,232 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 15:46:21,244 - app.services.device_health - INFO - Found device ir-dcf89f at new IP: 192.168.101.146
2025-10-07 15:46:21,421 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 15:46:21,428 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 15:50:45,179 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 15:51:21,429 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 15:51:21,429 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 15:51:24,260 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 15:51:24,475 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 15:51:24,491 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 15:54:47,178 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 15:54:47,178 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 15:54:47,178 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 15:54:47,178 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 15:54:47,211 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 15:54:47,211 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 15:54:47,211 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 15:54:47,211 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 15:55:47,217 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 15:56:24,492 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 15:56:24,492 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 15:56:27,214 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 15:56:27,427 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 15:56:27,431 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 16:00:49,256 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 16:01:27,431 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 16:01:27,431 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 16:01:30,110 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 16:01:30,340 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 16:01:30,344 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 16:01:51,916 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 16:01:51,917 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 16:01:51,917 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 16:01:51,917 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 16:02:27,546 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 16:02:27,546 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 16:02:27,546 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 16:02:27,546 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 16:05:51,317 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 16:06:30,344 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 16:06:30,345 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 16:06:33,049 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 16:06:33,263 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 16:06:33,267 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 16:07:34,774 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 16:07:34,774 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 16:07:34,774 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 16:07:34,774 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 16:08:51,024 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 16:08:51,024 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 16:08:51,024 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 16:08:51,024 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 16:08:51,093 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 16:08:51,093 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 16:08:51,094 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 16:08:51,094 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 16:10:53,355 - app.services.device_status_checker - INFO - Checking status of 3 devices
2025-10-07 16:11:04,771 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 16:11:04,771 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 16:11:04,771 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 16:11:04,772 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 16:11:33,267 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 16:11:33,267 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 16:11:35,748 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 16:11:35,964 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 16:11:35,968 - app.services.device_health - INFO - Health check complete: 1/1 devices online
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 16:15:48,358 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 16:15:48,358 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 16:15:48,358 - app.main - INFO - TV status polling service stopped
2025-10-07 16:15:48,358 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 16:15:48,358 - app.main - INFO - Device status monitoring stopped
2025-10-07 16:15:48,358 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 16:15:48,358 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 16:15:48,358 - app.main - INFO - Schedule processor stopped
2025-10-07 16:15:48,358 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 16:15:48,358 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 16:15:48,358 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 16:15:48,358 - app.main - INFO - History cleanup service stopped
2025-10-07 16:15:48,358 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 16:15:48,358 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 16:15:48,359 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 16:15:48,359 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 16:15:48,359 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 16:15:48,359 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 16:15:48,359 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 16:15:48,359 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 16:15:48,359 - app.main - INFO - Command queue processor stopped
2025-10-07 16:15:48,359 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 16:15:48,359 - app.main - INFO - Device health monitoring stopped
2025-10-07 16:15:48,359 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 16:15:48,359 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 16:15:48,359 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [587266]
Template seeding complete; using dynamic IR library system.
/home/coastal/smartvenue/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [592491]
INFO:     Waiting for application startup.
2025-10-07 16:15:50,030 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 16:15:50,036 - app.main - INFO - Database tables created
2025-10-07 16:15:50,058 - app.main - INFO - Database initialized with seed data
2025-10-07 16:15:50,058 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 16:15:50,059 - app.services.discovery - INFO - Device discovery started
2025-10-07 16:15:50,059 - app.main - INFO - Device discovery started
2025-10-07 16:15:50,059 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 16:15:50,059 - app.main - INFO - Device health monitoring started
2025-10-07 16:15:50,059 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 16:15:50,059 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 16:15:50,059 - app.main - INFO - Command queue processor started
2025-10-07 16:15:50,059 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 16:15:50,059 - app.main - INFO - History cleanup service started
2025-10-07 16:15:50,059 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 16:15:50,060 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 16:15:50,062 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 16:15:50,062 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 16:15:50,062 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 16:15:50,063 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 16:15:50,063 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 16:15:50,063 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 16:15:50,063 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 16:15:50,063 - app.main - INFO - Schedule processor started
2025-10-07 16:15:50,063 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 16:15:50,063 - app.main - INFO - Device status monitoring started
2025-10-07 16:15:50,063 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 16:15:50,063 - app.main - INFO - TV status polling service started
2025-10-07 16:15:50,064 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 16:15:50,068 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 16:15:50,069 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 16:15:50,069 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 10.7 hours)
2025-10-07 16:15:50,076 - app.services.device_status_checker - INFO - Checking status of 3 devices
INFO:     Application startup complete.
2025-10-07 16:15:52,287 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 16:15:52,288 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 16:15:52,288 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 16:15:52,288 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 16:15:52,299 - app.main - INFO - Saved loungefan to DeviceDiscovery table
2025-10-07 16:15:52,326 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 16:15:52,326 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 16:15:52,326 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 16:15:52,326 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 16:15:52,331 - app.main - ERROR - Error saving discovered device to database: (sqlite3.IntegrityError) UNIQUE constraint failed: device_discoveries.hostname
[SQL: INSERT INTO device_discoveries (hostname, mac_address, ip_address, friendly_name, device_type, firmware_version, discovery_properties, is_managed) VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING id, first_discovered, last_seen, created_at, updated_at]
[parameters: ('light-kitchen-right', 'right', '192.168.101.96', 'light-kitchen-right', 'universal', '2025.9.1', '{"friendly_name": "light-kitchen-right", "version": "2025.9.1", "mac": "c482e1bf8785", "platform": "BK7231T", "board": "generic-bk7231t-qfn32-tuya", "network": "wifi"}', 0)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-10-07 16:15:52,357 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 16:15:52,357 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 16:15:52,357 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 16:15:52,357 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 16:15:52,361 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 16:15:52,444 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 16:15:52,444 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 16:15:52,444 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 16:15:52,444 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 16:15:52,448 - app.main - ERROR - Error saving discovered device to database: (sqlite3.IntegrityError) UNIQUE constraint failed: device_discoveries.hostname
[SQL: INSERT INTO device_discoveries (hostname, mac_address, ip_address, friendly_name, device_type, firmware_version, discovery_properties, is_managed) VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING id, first_discovered, last_seen, created_at, updated_at]
[parameters: ('light-kitchen-left', 'left', '192.168.101.114', 'light-kitchen-left', 'universal', '2025.9.1', '{"friendly_name": "light-kitchen-left", "version": "2025.9.1", "mac": "c482e1bf96d6", "platform": "BK7231T", "board": "generic-bk7231t-qfn32-tuya", "network": "wifi"}', 0)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-10-07 16:15:52,477 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 16:15:52,477 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 16:15:52,477 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 16:15:52,477 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 16:15:52,481 - app.main - INFO - Saved presence-garage to DeviceDiscovery table
2025-10-07 16:15:53,252 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 16:15:53,253 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 16:15:53,253 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 16:15:53,253 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 16:15:53,256 - app.main - INFO - Saved ir-dca09e to DeviceDiscovery table
2025-10-07 16:15:53,302 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 16:15:53,302 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 16:15:53,302 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 16:15:53,302 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 16:15:53,305 - app.main - INFO - Saved kitchen-fan to DeviceDiscovery table
2025-10-07 16:15:53,305 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 16:15:53,305 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 16:15:53,305 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 16:15:53,306 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 16:15:53,309 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
2025-10-07 16:15:53,356 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 16:15:53,356 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 16:15:53,356 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 16:15:53,356 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 16:15:53,362 - app.main - INFO - Saved bt-proxy-office to DeviceDiscovery table
2025-10-07 16:15:53,415 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 16:15:53,415 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 16:15:53,416 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 16:15:53,416 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 16:15:53,419 - app.main - INFO - Saved waterheater to DeviceDiscovery table
2025-10-07 16:15:53,425 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 16:15:53,426 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 16:15:53,426 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 16:15:53,426 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 16:15:53,428 - app.main - INFO - Saved bt-proxy-garage to DeviceDiscovery table
2025-10-07 16:15:53,488 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 16:15:53,488 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 16:15:53,488 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 16:15:53,488 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 16:15:53,491 - app.main - INFO - Saved esp32-bluetooth-proxy-f32ccc to DeviceDiscovery table
2025-10-07 16:16:07,417 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 16:16:07,418 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 16:16:07,418 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 16:16:07,418 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 16:16:07,421 - app.main - INFO - Saved ir-dc4516 to DeviceDiscovery table
2025-10-07 16:20:50,064 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 16:20:50,065 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 16:20:52,128 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 16:20:54,167 - app.services.device_status_checker - INFO - Device nw-b85a97 status changed: online=True, power=on
2025-10-07 16:20:54,189 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 16:21:00,067 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error while finishing connection: Finishing connection cancelled
2025-10-07 16:21:00,067 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dcf89f
2025-10-07 16:21:00,067 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: Connection lost
2025-10-07 16:21:03,138 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 16:21:06,210 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 16:21:09,282 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 16:21:12,354 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 16:21:15,426 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 16:21:18,498 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 16:21:18,543 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 16:21:21,634 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 16:21:24,706 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 16:21:27,778 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 16:21:31,117 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 16:21:31,129 - app.services.device_health - INFO - Found device ir-dcf89f at new IP: 192.168.101.146
2025-10-07 16:21:31,365 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 16:21:31,580 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 16:21:31,585 - app.services.device_health - INFO - Health check complete: 2/2 devices online
2025-10-07 16:21:43,376 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 16:21:43,376 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 16:21:43,376 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 16:21:43,376 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 16:21:43,382 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 16:25:54,171 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 16:26:31,586 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 16:26:31,586 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 16:26:34,047 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 16:26:41,587 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error while finishing connection: Finishing connection cancelled
2025-10-07 16:26:41,587 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dcf89f
2025-10-07 16:26:41,587 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: Connection lost
2025-10-07 16:26:44,642 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 16:26:47,714 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 16:26:48,598 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 16:26:48,598 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 16:26:48,598 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 16:26:48,598 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 16:26:48,602 - app.main - INFO - Saved ir-dc4516 to DeviceDiscovery table
2025-10-07 16:26:50,786 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 16:26:53,858 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 16:26:56,930 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 16:27:00,002 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 16:27:00,053 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 16:27:03,138 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 16:27:06,210 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 16:27:09,282 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 16:27:11,992 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 16:27:12,015 - app.services.device_health - INFO - Found device ir-dcf89f at new IP: 192.168.101.146
2025-10-07 16:27:12,233 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 16:27:12,418 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 16:27:12,422 - app.services.device_health - INFO - Health check complete: 2/2 devices online
2025-10-07 16:29:56,212 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 16:29:56,212 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 16:29:56,212 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 16:29:56,212 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 16:29:56,219 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 16:29:56,232 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 16:29:56,233 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 16:29:56,233 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 16:29:56,233 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 16:29:56,236 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 16:30:56,214 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 16:32:12,423 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 16:32:12,423 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 16:32:15,139 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 16:32:15,195 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 16:32:15,430 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 16:32:15,614 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 16:32:15,618 - app.services.device_health - INFO - Health check complete: 2/2 devices online
2025-10-07 16:35:58,255 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 16:37:15,618 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 16:37:15,619 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 16:37:18,342 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 16:37:18,358 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 16:37:18,576 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 16:37:18,766 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 16:37:18,771 - app.services.device_health - INFO - Health check complete: 2/2 devices online
2025-10-07 16:39:54,153 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 16:39:54,153 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 16:39:54,153 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 16:39:54,153 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 16:39:54,156 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
2025-10-07 16:41:00,295 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 16:42:18,771 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 16:42:18,771 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 16:42:20,707 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 16:42:20,707 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 16:42:20,708 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dcf89f
2025-10-07 16:42:21,463 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 16:42:23,714 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 16:42:26,786 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 16:42:29,858 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 16:42:32,930 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 16:42:36,002 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 16:42:39,074 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 16:42:39,078 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 16:42:42,146 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 16:42:45,218 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 16:42:48,290 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 16:42:50,077 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 16:42:50,078 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 16:42:53,154 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.147', 6053): [Errno 113] Connect call failed ('192.168.101.147', 6053)
2025-10-07 16:42:56,226 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.148', 6053): [Errno 113] Connect call failed ('192.168.101.148', 6053)
2025-10-07 16:42:59,298 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.149', 6053): [Errno 113] Connect call failed ('192.168.101.149', 6053)
2025-10-07 16:43:02,370 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.150', 6053): [Errno 113] Connect call failed ('192.168.101.150', 6053)
2025-10-07 16:43:05,442 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.151', 6053): [Errno 113] Connect call failed ('192.168.101.151', 6053)
2025-10-07 16:43:08,514 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.152', 6053): [Errno 113] Connect call failed ('192.168.101.152', 6053)
2025-10-07 16:43:08,515 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.153', 6053): [Errno 111] Connect call failed ('192.168.101.153', 6053)
2025-10-07 16:43:11,586 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.154', 6053): [Errno 113] Connect call failed ('192.168.101.154', 6053)
2025-10-07 16:43:21,587 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error while starting connection: Starting connection cancelled
2025-10-07 16:43:24,642 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.156', 6053): [Errno 113] Connect call failed ('192.168.101.156', 6053)
2025-10-07 16:43:24,862 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 16:43:24,867 - app.services.device_health - INFO - Health check complete: 1/2 devices online
2025-10-07 16:44:00,126 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 16:44:00,126 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 16:44:00,126 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 16:44:00,126 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 16:44:00,129 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 16:44:00,177 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 16:44:00,177 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 16:44:00,177 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 16:44:00,177 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 16:44:00,184 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 16:46:02,336 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 16:46:31,028 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 16:46:31,028 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 16:46:31,028 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 16:46:31,028 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 16:46:31,034 - app.main - INFO - Saved ir-dca09e to DeviceDiscovery table
2025-10-07 16:48:24,866 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 16:48:24,867 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 16:48:26,475 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 16:48:26,475 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 16:48:26,475 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dcf89f
2025-10-07 16:48:27,883 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 16:48:29,474 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 16:48:32,547 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 16:48:35,618 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 16:48:38,690 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 16:48:41,762 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 16:48:44,834 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 16:48:44,870 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 16:48:47,970 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 16:48:51,042 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 16:48:54,114 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 16:48:56,380 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 16:48:56,380 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 16:48:59,490 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.147', 6053): [Errno 113] Connect call failed ('192.168.101.147', 6053)
2025-10-07 16:49:02,562 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.148', 6053): [Errno 113] Connect call failed ('192.168.101.148', 6053)
2025-10-07 16:49:05,634 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.149', 6053): [Errno 113] Connect call failed ('192.168.101.149', 6053)
2025-10-07 16:49:08,706 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.150', 6053): [Errno 113] Connect call failed ('192.168.101.150', 6053)
2025-10-07 16:49:11,778 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.151', 6053): [Errno 113] Connect call failed ('192.168.101.151', 6053)
2025-10-07 16:49:13,581 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 16:49:13,581 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 16:49:13,581 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 16:49:13,581 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 16:49:13,588 - app.main - INFO - Saved ir-dc4516 to DeviceDiscovery table
2025-10-07 16:49:14,850 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.152', 6053): [Errno 113] Connect call failed ('192.168.101.152', 6053)
2025-10-07 16:49:14,851 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.153', 6053): [Errno 111] Connect call failed ('192.168.101.153', 6053)
2025-10-07 16:49:17,922 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.154', 6053): [Errno 113] Connect call failed ('192.168.101.154', 6053)
2025-10-07 16:49:27,922 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error while starting connection: Starting connection cancelled
2025-10-07 16:49:30,978 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.156', 6053): [Errno 113] Connect call failed ('192.168.101.156', 6053)
2025-10-07 16:49:31,158 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 16:49:31,162 - app.services.device_health - INFO - Health check complete: 1/2 devices online
2025-10-07 16:51:04,378 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 16:54:31,163 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 16:54:31,163 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 16:54:31,578 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 16:54:31,578 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 16:54:31,578 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 16:54:31,578 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 16:54:31,585 - app.main - INFO - Saved ir-dc4516 to DeviceDiscovery table
2025-10-07 16:54:33,793 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 16:54:34,040 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 16:54:34,238 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 16:54:34,418 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 16:54:34,422 - app.services.device_health - INFO - Health check complete: 2/2 devices online
2025-10-07 16:56:06,422 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 16:58:03,885 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 16:58:03,885 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 16:58:03,885 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 16:58:03,885 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 16:58:03,888 - app.main - INFO - Saved ir-dca09e to DeviceDiscovery table
2025-10-07 16:58:03,967 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 16:58:03,967 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 16:58:03,967 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 16:58:03,968 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 16:58:03,973 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 16:58:04,002 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 16:58:04,002 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 16:58:04,002 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 16:58:04,002 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 16:58:04,008 - app.main - INFO - Saved kitchen-fan to DeviceDiscovery table
2025-10-07 16:58:04,010 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 16:58:04,011 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 16:58:04,011 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 16:58:04,011 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 16:58:04,013 - app.main - INFO - Saved loungefan to DeviceDiscovery table
2025-10-07 16:58:04,013 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 16:58:04,014 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 16:58:04,014 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 16:58:04,014 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 16:58:04,017 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
2025-10-07 16:58:04,047 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 16:58:04,047 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 16:58:04,047 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 16:58:04,047 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 16:58:04,050 - app.main - INFO - Saved bt-proxy-office to DeviceDiscovery table
2025-10-07 16:58:04,054 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 16:58:04,055 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 16:58:04,055 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 16:58:04,055 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 16:58:04,062 - app.main - INFO - Saved presence-garage to DeviceDiscovery table
2025-10-07 16:58:04,062 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 16:58:04,063 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 16:58:04,063 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 16:58:04,063 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 16:58:04,065 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 16:58:04,070 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 16:58:04,070 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 16:58:04,070 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 16:58:04,070 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 16:58:04,081 - app.main - INFO - Saved waterheater to DeviceDiscovery table
2025-10-07 16:58:04,101 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 16:58:04,101 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 16:58:04,101 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 16:58:04,101 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 16:58:04,107 - app.main - INFO - Saved bt-proxy-garage to DeviceDiscovery table
2025-10-07 16:58:04,112 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 16:58:04,112 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 16:58:04,113 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 16:58:04,113 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 16:58:04,115 - app.main - INFO - Saved esp32-bluetooth-proxy-f32ccc to DeviceDiscovery table
2025-10-07 16:58:04,122 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 16:58:04,122 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 16:58:04,122 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 16:58:04,122 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 16:58:04,125 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 16:59:34,421 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 16:59:34,422 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 16:59:36,810 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 16:59:37,069 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 16:59:37,267 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 16:59:37,445 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 16:59:37,450 - app.services.device_health - INFO - Health check complete: 2/2 devices online
2025-10-07 17:00:31,982 - app.services.discovery - INFO - mDNS service discovered: oliversfan._esphomelib._tcp.local.
2025-10-07 17:00:31,982 - app.services.discovery - INFO - Processing mDNS device: oliversfan at 192.168.101.24:6053
2025-10-07 17:00:31,982 - app.services.discovery - INFO - Discovered ESPHome device: oliversfan (192.168.101.24)
2025-10-07 17:00:31,982 - app.main - INFO - New device discovered: oliversfan (192.168.101.24)
2025-10-07 17:00:31,985 - app.main - INFO - Saved oliversfan to DeviceDiscovery table
2025-10-07 17:01:08,465 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 17:01:22,906 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 17:01:22,907 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 17:01:22,907 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:01:22,907 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:01:22,913 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 17:04:37,450 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 17:04:37,450 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 17:04:39,843 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 17:04:39,900 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 17:04:40,111 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 17:04:40,299 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 17:04:40,303 - app.services.device_health - INFO - Health check complete: 2/2 devices online
2025-10-07 17:06:10,507 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 17:09:40,303 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 17:09:40,303 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 17:09:43,024 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 17:09:44,219 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 17:09:44,418 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 17:09:44,607 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 17:09:44,612 - app.services.device_health - INFO - Health check complete: 2/2 devices online
2025-10-07 17:10:30,866 - app.services.queue_processor - INFO - Worker 0 executing command 2: power_off on ir-dcf89f port 2 (attempt 1)
2025-10-07 17:10:30,876 - app.services.queue_processor - INFO - Worker 1 executing command 1: power_off on ir-dcf89f port 1 (attempt 1)
2025-10-07 17:11:00,871 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: Timeout during handshake
2025-10-07 17:11:00,875 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 2: Command execution failed (attempt 1)
2025-10-07 17:11:00,875 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: Connection lost
2025-10-07 17:11:00,878 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: Timeout during handshake
2025-10-07 17:11:00,882 - app.services.queue_processor - WARNING - ‚úó Worker 1 failed command 1: Command execution failed (attempt 1)
2025-10-07 17:11:00,882 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: Connection lost
2025-10-07 17:11:02,881 - app.services.queue_processor - INFO - Worker 0 executing command 2: power_off on ir-dcf89f port 2 (attempt 2)
2025-10-07 17:11:02,887 - app.services.queue_processor - INFO - Worker 1 executing command 1: power_off on ir-dcf89f port 1 (attempt 2)
2025-10-07 17:11:05,813 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 17:11:05,814 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 17:11:05,967 - app.services.esphome_client - INFO - Called service 'tv_power_off' on ir-dcf89f with data: {'port': 1}
2025-10-07 17:11:05,973 - app.services.queue_processor - INFO - ‚úì Worker 1 completed command 1 in 3079ms
2025-10-07 17:11:05,974 - app.services.esphome_client - INFO - Called service 'tv_power_off' on ir-dcf89f with data: {'port': 2}
2025-10-07 17:11:05,979 - app.services.queue_processor - INFO - ‚úì Worker 0 completed command 2 in 3092ms
2025-10-07 17:11:12,546 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 17:11:15,597 - app.services.device_status_checker - INFO - Device nw-b85a97 status changed: online=False, power=off
2025-10-07 17:12:07,910 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 17:12:07,910 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 17:12:07,910 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 17:12:07,910 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 17:12:07,913 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 17:12:07,974 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 17:12:07,974 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 17:12:07,974 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 17:12:07,974 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 17:12:07,981 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
WARNING:  WatchFiles detected changes in 'app/api/hybrid_devices.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 17:13:47,248 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 17:13:47,248 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 17:13:47,248 - app.main - INFO - TV status polling service stopped
2025-10-07 17:13:47,248 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 17:13:47,248 - app.main - INFO - Device status monitoring stopped
2025-10-07 17:13:47,248 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 17:13:47,248 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 17:13:47,249 - app.main - INFO - Schedule processor stopped
2025-10-07 17:13:47,249 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 17:13:47,249 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 17:13:47,249 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 17:13:47,249 - app.main - INFO - History cleanup service stopped
2025-10-07 17:13:47,249 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 17:13:47,249 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 17:13:47,249 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 17:13:47,249 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 17:13:47,249 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 17:13:47,249 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 17:13:47,249 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 17:13:47,249 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 17:13:47,249 - app.main - INFO - Command queue processor stopped
2025-10-07 17:13:47,249 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 17:13:47,249 - app.main - INFO - Device health monitoring stopped
2025-10-07 17:13:47,249 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 17:13:47,250 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 17:13:47,250 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [592491]
Template seeding complete; using dynamic IR library system.
/home/coastal/smartvenue/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [593229]
INFO:     Waiting for application startup.
2025-10-07 17:13:48,941 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 17:13:48,947 - app.main - INFO - Database tables created
2025-10-07 17:13:48,969 - app.main - INFO - Database initialized with seed data
2025-10-07 17:13:48,969 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 17:13:48,970 - app.services.discovery - INFO - Device discovery started
2025-10-07 17:13:48,970 - app.main - INFO - Device discovery started
2025-10-07 17:13:48,970 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 17:13:48,970 - app.main - INFO - Device health monitoring started
2025-10-07 17:13:48,970 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 17:13:48,970 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 17:13:48,970 - app.main - INFO - Command queue processor started
2025-10-07 17:13:48,970 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 17:13:48,970 - app.main - INFO - History cleanup service started
2025-10-07 17:13:48,971 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 17:13:48,972 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 17:13:48,974 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 17:13:48,974 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 17:13:48,974 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 17:13:48,974 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 17:13:48,974 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 17:13:48,975 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 17:13:48,975 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 17:13:48,975 - app.main - INFO - Schedule processor started
2025-10-07 17:13:48,975 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 17:13:48,975 - app.main - INFO - Device status monitoring started
2025-10-07 17:13:48,975 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 17:13:48,975 - app.main - INFO - TV status polling service started
2025-10-07 17:13:48,975 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 17:13:48,980 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 17:13:48,980 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 17:13:48,981 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 9.8 hours)
2025-10-07 17:13:48,988 - app.services.device_status_checker - INFO - Checking status of 4 devices
INFO:     Application startup complete.
2025-10-07 17:13:52,146 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 17:13:52,146 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 17:13:52,146 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 17:13:52,146 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 17:13:52,156 - app.main - INFO - Saved ir-dc4516 to DeviceDiscovery table
2025-10-07 17:13:52,230 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 17:13:52,230 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 17:13:52,230 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 17:13:52,230 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 17:13:52,237 - app.main - INFO - Saved loungefan to DeviceDiscovery table
2025-10-07 17:13:52,328 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 17:13:52,329 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 17:13:52,329 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 17:13:52,329 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 17:13:52,336 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 17:13:52,336 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 17:13:52,337 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 17:13:52,337 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 17:13:52,337 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 17:13:52,339 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 17:13:52,417 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 17:13:52,418 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 17:13:52,418 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 17:13:52,418 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 17:13:52,421 - app.main - INFO - Saved presence-garage to DeviceDiscovery table
2025-10-07 17:13:53,165 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 17:13:53,165 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 17:13:53,165 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 17:13:53,165 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 17:13:53,169 - app.main - INFO - Saved ir-dca09e to DeviceDiscovery table
2025-10-07 17:13:53,217 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 17:13:53,217 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 17:13:53,217 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:13:53,217 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:13:53,224 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 17:13:53,253 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 17:13:53,253 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 17:13:53,253 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 17:13:53,253 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 17:13:53,260 - app.main - INFO - Saved kitchen-fan to DeviceDiscovery table
2025-10-07 17:13:53,260 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 17:13:53,260 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 17:13:53,260 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 17:13:53,261 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 17:13:53,264 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
2025-10-07 17:13:53,334 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 17:13:53,334 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 17:13:53,334 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 17:13:53,334 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 17:13:53,340 - app.main - INFO - Saved esp32-bluetooth-proxy-f32ccc to DeviceDiscovery table
2025-10-07 17:13:53,354 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 17:13:53,354 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 17:13:53,354 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 17:13:53,354 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 17:13:53,361 - app.main - INFO - Saved waterheater to DeviceDiscovery table
2025-10-07 17:13:53,376 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 17:13:53,376 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 17:13:53,376 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 17:13:53,376 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 17:13:53,382 - app.main - INFO - Saved bt-proxy-garage to DeviceDiscovery table
2025-10-07 17:13:53,402 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 17:13:53,402 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 17:13:53,402 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 17:13:53,402 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 17:13:53,405 - app.main - INFO - Saved bt-proxy-office to DeviceDiscovery table
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 17:16:11,601 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 17:16:11,601 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 17:16:11,601 - app.main - INFO - TV status polling service stopped
2025-10-07 17:16:11,601 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 17:16:11,601 - app.main - INFO - Device status monitoring stopped
2025-10-07 17:16:11,601 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 17:16:11,601 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 17:16:11,601 - app.main - INFO - Schedule processor stopped
2025-10-07 17:16:11,601 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 17:16:11,601 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 17:16:11,601 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 17:16:11,601 - app.main - INFO - History cleanup service stopped
2025-10-07 17:16:11,601 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 17:16:11,601 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 17:16:11,601 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 17:16:11,601 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 17:16:11,601 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 17:16:11,601 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 17:16:11,601 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 17:16:11,601 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 17:16:11,601 - app.main - INFO - Command queue processor stopped
2025-10-07 17:16:11,601 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 17:16:11,601 - app.main - INFO - Device health monitoring stopped
2025-10-07 17:16:11,601 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 17:16:11,602 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 17:16:11,602 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [593229]
Template seeding complete; using dynamic IR library system.
/home/coastal/smartvenue/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [593277]
INFO:     Waiting for application startup.
2025-10-07 17:16:13,240 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 17:16:13,245 - app.main - INFO - Database tables created
2025-10-07 17:16:13,267 - app.main - INFO - Database initialized with seed data
2025-10-07 17:16:13,267 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 17:16:13,268 - app.services.discovery - INFO - Device discovery started
2025-10-07 17:16:13,268 - app.main - INFO - Device discovery started
2025-10-07 17:16:13,268 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 17:16:13,268 - app.main - INFO - Device health monitoring started
2025-10-07 17:16:13,268 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 17:16:13,268 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 17:16:13,268 - app.main - INFO - Command queue processor started
2025-10-07 17:16:13,268 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 17:16:13,268 - app.main - INFO - History cleanup service started
2025-10-07 17:16:13,268 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 17:16:13,269 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 17:16:13,271 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 17:16:13,271 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 17:16:13,271 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 17:16:13,271 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 17:16:13,272 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 17:16:13,272 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 17:16:13,272 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 17:16:13,272 - app.main - INFO - Schedule processor started
2025-10-07 17:16:13,272 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 17:16:13,272 - app.main - INFO - Device status monitoring started
2025-10-07 17:16:13,272 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 17:16:13,272 - app.main - INFO - TV status polling service started
2025-10-07 17:16:13,273 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 17:16:13,277 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 17:16:13,278 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 17:16:13,278 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 9.7 hours)
2025-10-07 17:16:13,285 - app.services.device_status_checker - INFO - Checking status of 4 devices
INFO:     Application startup complete.
2025-10-07 17:16:16,404 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 17:16:16,404 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 17:16:16,404 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 17:16:16,404 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 17:16:16,413 - app.main - INFO - Saved ir-dc4516 to DeviceDiscovery table
2025-10-07 17:16:16,413 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 17:16:16,413 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 17:16:16,413 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:16:16,413 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:16:16,416 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 17:16:16,516 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 17:16:16,517 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 17:16:16,517 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 17:16:16,517 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 17:16:16,520 - app.main - INFO - Saved loungefan to DeviceDiscovery table
2025-10-07 17:16:16,560 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 17:16:16,561 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 17:16:16,561 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 17:16:16,561 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 17:16:16,564 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 17:16:16,566 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 17:16:16,566 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 17:16:16,567 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 17:16:16,567 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 17:16:16,570 - app.main - INFO - Saved presence-garage to DeviceDiscovery table
2025-10-07 17:16:16,635 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 17:16:16,636 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 17:16:16,636 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 17:16:16,636 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 17:16:16,643 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 17:16:17,431 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 17:16:17,432 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 17:16:17,432 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 17:16:17,432 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 17:16:17,438 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
2025-10-07 17:16:17,485 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 17:16:17,485 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 17:16:17,485 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 17:16:17,485 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 17:16:17,488 - app.main - INFO - Saved ir-dca09e to DeviceDiscovery table
2025-10-07 17:16:17,543 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 17:16:17,543 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 17:16:17,543 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 17:16:17,544 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 17:16:17,547 - app.main - INFO - Saved kitchen-fan to DeviceDiscovery table
2025-10-07 17:16:17,590 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 17:16:17,590 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 17:16:17,591 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 17:16:17,591 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 17:16:17,594 - app.main - INFO - Saved bt-proxy-office to DeviceDiscovery table
2025-10-07 17:16:17,637 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 17:16:17,637 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 17:16:17,637 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 17:16:17,637 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 17:16:17,640 - app.main - INFO - Saved waterheater to DeviceDiscovery table
2025-10-07 17:16:17,672 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 17:16:17,672 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 17:16:17,672 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 17:16:17,672 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 17:16:17,675 - app.main - INFO - Saved bt-proxy-garage to DeviceDiscovery table
2025-10-07 17:16:17,738 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 17:16:17,738 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 17:16:17,738 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 17:16:17,738 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 17:16:17,741 - app.main - INFO - Saved esp32-bluetooth-proxy-f32ccc to DeviceDiscovery table
2025-10-07 17:21:13,273 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 17:21:13,275 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 17:21:15,043 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:21:15,044 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:21:15,044 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dcf89f
2025-10-07 17:21:15,779 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 17:21:16,356 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 17:21:19,411 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 17:21:22,466 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 17:21:23,000 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 17:21:23,001 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 17:21:23,001 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 17:21:23,001 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 17:21:23,007 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
2025-10-07 17:21:25,538 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 17:21:28,610 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 17:21:31,682 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 17:21:34,754 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 17:21:34,797 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 17:21:37,890 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 17:21:40,962 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 17:21:44,034 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 17:21:46,072 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:21:46,072 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:21:49,154 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.147', 6053): [Errno 113] Connect call failed ('192.168.101.147', 6053)
2025-10-07 17:21:52,226 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.148', 6053): [Errno 113] Connect call failed ('192.168.101.148', 6053)
2025-10-07 17:21:55,298 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.149', 6053): [Errno 113] Connect call failed ('192.168.101.149', 6053)
2025-10-07 17:21:58,370 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.150', 6053): [Errno 113] Connect call failed ('192.168.101.150', 6053)
2025-10-07 17:22:01,442 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.151', 6053): [Errno 113] Connect call failed ('192.168.101.151', 6053)
2025-10-07 17:22:04,514 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.152', 6053): [Errno 113] Connect call failed ('192.168.101.152', 6053)
2025-10-07 17:22:04,515 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.153', 6053): [Errno 111] Connect call failed ('192.168.101.153', 6053)
2025-10-07 17:22:07,586 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.154', 6053): [Errno 113] Connect call failed ('192.168.101.154', 6053)
2025-10-07 17:22:17,587 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error while starting connection: Starting connection cancelled
2025-10-07 17:22:20,642 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.156', 6053): [Errno 113] Connect call failed ('192.168.101.156', 6053)
2025-10-07 17:22:20,848 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 17:22:20,855 - app.services.device_health - INFO - Health check complete: 1/2 devices online
2025-10-07 17:24:40,939 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 17:24:40,939 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 17:24:40,939 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 17:24:40,939 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 17:24:40,942 - app.main - INFO - Saved ir-dca09e to DeviceDiscovery table
2025-10-07 17:26:19,410 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 17:27:20,856 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 17:27:20,856 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 17:27:23,204 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:27:23,204 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:27:23,204 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dcf89f
2025-10-07 17:27:23,293 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 17:27:26,306 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 17:27:29,378 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 17:27:32,450 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 17:27:35,522 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 17:27:37,571 - app.services.queue_processor - INFO - Worker 0 executing command 4: power_on on ir-dcf89f port 1 (attempt 1)
2025-10-07 17:27:38,594 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 17:27:39,019 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:27:39,019 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:27:39,023 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 4: Command execution failed (attempt 1)
2025-10-07 17:27:41,029 - app.services.queue_processor - INFO - Worker 0 executing command 4: power_on on ir-dcf89f port 1 (attempt 2)
2025-10-07 17:27:41,666 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 17:27:41,705 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 17:27:42,805 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:27:42,805 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:27:42,809 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 4: Command execution failed (attempt 2)
2025-10-07 17:27:44,802 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 17:27:46,817 - app.services.queue_processor - INFO - Worker 0 executing command 4: power_on on ir-dcf89f port 1 (attempt 3)
2025-10-07 17:27:47,874 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 17:27:48,466 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:27:48,466 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:27:48,472 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 4: Command execution failed (attempt 3)
2025-10-07 17:27:50,946 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 17:27:53,024 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:27:53,024 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:27:56,130 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.147', 6053): [Errno 113] Connect call failed ('192.168.101.147', 6053)
2025-10-07 17:27:59,202 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.148', 6053): [Errno 113] Connect call failed ('192.168.101.148', 6053)
2025-10-07 17:28:02,275 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.149', 6053): [Errno 113] Connect call failed ('192.168.101.149', 6053)
2025-10-07 17:28:05,346 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.150', 6053): [Errno 113] Connect call failed ('192.168.101.150', 6053)
2025-10-07 17:28:08,418 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.151', 6053): [Errno 113] Connect call failed ('192.168.101.151', 6053)
2025-10-07 17:28:11,490 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.152', 6053): [Errno 113] Connect call failed ('192.168.101.152', 6053)
2025-10-07 17:28:11,491 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.153', 6053): [Errno 111] Connect call failed ('192.168.101.153', 6053)
2025-10-07 17:28:14,562 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.154', 6053): [Errno 113] Connect call failed ('192.168.101.154', 6053)
2025-10-07 17:28:24,563 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error while starting connection: Starting connection cancelled
2025-10-07 17:28:27,618 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.156', 6053): [Errno 113] Connect call failed ('192.168.101.156', 6053)
2025-10-07 17:28:27,821 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 17:28:27,826 - app.services.device_health - INFO - Health check complete: 1/2 devices online
2025-10-07 17:29:09,065 - app.services.queue_processor - INFO - Worker 0 executing command 5: power on ir-dcf89f port 1 (attempt 1)
2025-10-07 17:29:11,270 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:29:11,271 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:29:11,274 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 5: Command execution failed (attempt 1)
2025-10-07 17:29:13,280 - app.services.queue_processor - INFO - Worker 0 executing command 5: power on ir-dcf89f port 1 (attempt 2)
2025-10-07 17:29:14,973 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:29:14,973 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:29:14,976 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 5: Command execution failed (attempt 2)
2025-10-07 17:29:18,986 - app.services.queue_processor - INFO - Worker 0 executing command 5: power on ir-dcf89f port 1 (attempt 3)
2025-10-07 17:29:20,640 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:29:20,640 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:29:20,644 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 5: Command execution failed (attempt 3)
2025-10-07 17:30:20,377 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 17:30:20,377 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 17:30:20,377 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 17:30:20,377 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 17:30:20,384 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 17:30:20,453 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 17:30:20,453 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 17:30:20,453 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 17:30:20,453 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 17:30:20,456 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 17:30:20,728 - app.services.queue_processor - INFO - Worker 0 executing command 6: power_on on ir-dcf89f port 1 (attempt 1)
2025-10-07 17:30:23,443 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:30:23,443 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:30:23,447 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 6: Command execution failed (attempt 1)
2025-10-07 17:30:25,454 - app.services.queue_processor - INFO - Worker 0 executing command 6: power_on on ir-dcf89f port 1 (attempt 2)
2025-10-07 17:30:27,107 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:30:27,108 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:30:27,111 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 6: Command execution failed (attempt 2)
2025-10-07 17:30:31,121 - app.services.queue_processor - INFO - Worker 0 executing command 6: power_on on ir-dcf89f port 1 (attempt 3)
2025-10-07 17:30:32,676 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:30:32,676 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:30:32,680 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 6: Command execution failed (attempt 3)
2025-10-07 17:31:22,465 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 17:33:27,826 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 17:33:27,826 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 17:33:30,098 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:33:30,098 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:33:30,098 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dcf89f
2025-10-07 17:33:30,502 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 17:33:33,154 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 17:33:36,226 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 17:33:38,209 - app.services.queue_processor - INFO - Worker 0 executing command 7: power_off on ir-dcf89f port 1 (attempt 1)
2025-10-07 17:33:39,298 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 17:33:39,900 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:33:39,900 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:33:39,903 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 7: Command execution failed (attempt 1)
2025-10-07 17:33:41,909 - app.services.queue_processor - INFO - Worker 0 executing command 7: power_off on ir-dcf89f port 1 (attempt 2)
2025-10-07 17:33:42,370 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 17:33:43,598 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:33:43,598 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:33:43,602 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 7: Command execution failed (attempt 2)
2025-10-07 17:33:45,442 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 17:33:47,613 - app.services.queue_processor - INFO - Worker 0 executing command 7: power_off on ir-dcf89f port 1 (attempt 3)
2025-10-07 17:33:48,514 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 17:33:48,615 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 17:33:49,314 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:33:49,314 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:33:49,318 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 7: Command execution failed (attempt 3)
2025-10-07 17:33:51,714 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 17:33:54,786 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 17:33:57,858 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 17:33:59,460 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:33:59,460 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:34:02,466 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.147', 6053): [Errno 113] Connect call failed ('192.168.101.147', 6053)
2025-10-07 17:34:05,538 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.148', 6053): [Errno 113] Connect call failed ('192.168.101.148', 6053)
2025-10-07 17:34:08,610 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.149', 6053): [Errno 113] Connect call failed ('192.168.101.149', 6053)
2025-10-07 17:34:11,682 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.150', 6053): [Errno 113] Connect call failed ('192.168.101.150', 6053)
2025-10-07 17:34:14,754 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.151', 6053): [Errno 113] Connect call failed ('192.168.101.151', 6053)
2025-10-07 17:34:17,826 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.152', 6053): [Errno 113] Connect call failed ('192.168.101.152', 6053)
2025-10-07 17:34:17,827 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.153', 6053): [Errno 111] Connect call failed ('192.168.101.153', 6053)
2025-10-07 17:34:20,898 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.154', 6053): [Errno 113] Connect call failed ('192.168.101.154', 6053)
2025-10-07 17:34:30,899 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error while starting connection: Starting connection cancelled
2025-10-07 17:34:33,954 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.156', 6053): [Errno 113] Connect call failed ('192.168.101.156', 6053)
2025-10-07 17:34:34,143 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 17:34:34,148 - app.services.device_health - INFO - Health check complete: 1/2 devices online
2025-10-07 17:34:39,786 - app.services.queue_processor - INFO - Worker 1 executing command 8: volume_up on ir-dcf89f port 1 (attempt 1)
2025-10-07 17:34:41,511 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:34:41,511 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:34:41,515 - app.services.queue_processor - WARNING - ‚úó Worker 1 failed command 8: Command execution failed (attempt 1)
2025-10-07 17:34:42,296 - app.services.queue_processor - INFO - Worker 2 executing command 9: volume_up on ir-dcf89f port 1 (attempt 1)
2025-10-07 17:34:43,521 - app.services.queue_processor - INFO - Worker 1 executing command 8: volume_up on ir-dcf89f port 1 (attempt 2)
2025-10-07 17:34:43,998 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:34:43,998 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:34:44,002 - app.services.queue_processor - WARNING - ‚úó Worker 2 failed command 9: Command execution failed (attempt 1)
2025-10-07 17:34:44,096 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:34:44,096 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:34:44,100 - app.services.queue_processor - WARNING - ‚úó Worker 1 failed command 8: Command execution failed (attempt 2)
2025-10-07 17:34:46,008 - app.services.queue_processor - INFO - Worker 2 executing command 9: volume_up on ir-dcf89f port 1 (attempt 2)
2025-10-07 17:34:46,347 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:34:46,348 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:34:46,351 - app.services.queue_processor - WARNING - ‚úó Worker 2 failed command 9: Command execution failed (attempt 2)
2025-10-07 17:34:48,107 - app.services.queue_processor - INFO - Worker 1 executing command 8: volume_up on ir-dcf89f port 1 (attempt 3)
2025-10-07 17:34:49,766 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:34:49,767 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:34:49,770 - app.services.queue_processor - WARNING - ‚úó Worker 1 failed command 8: Command execution failed (attempt 3)
2025-10-07 17:34:50,361 - app.services.queue_processor - INFO - Worker 2 executing command 9: volume_up on ir-dcf89f port 1 (attempt 3)
2025-10-07 17:34:52,093 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: EOF received
2025-10-07 17:34:52,093 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: 192.168.101.146: EOF received
2025-10-07 17:34:52,097 - app.services.queue_processor - WARNING - ‚úó Worker 2 failed command 9: Command execution failed (attempt 3)
2025-10-07 17:36:25,520 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 17:36:27,559 - app.services.device_status_checker - INFO - Device nw-b85a97 status changed: online=True, power=on
2025-10-07 17:39:34,147 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 17:39:34,148 - app.services.device_health - INFO - Checking health of 3 managed devices
2025-10-07 17:39:34,260 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 17:39:34,260 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 17:39:34,260 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:39:34,260 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:39:34,264 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 17:39:36,588 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 17:39:44,148 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error while finishing connection: Finishing connection cancelled
2025-10-07 17:39:44,148 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dcf89f
2025-10-07 17:39:44,148 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: Connection lost
2025-10-07 17:39:44,148 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error while finishing connection: Finishing connection cancelled
2025-10-07 17:39:44,148 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dc4516
2025-10-07 17:39:44,149 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: Connection lost
2025-10-07 17:39:47,234 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 17:39:47,234 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 17:39:50,306 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 17:39:50,306 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 17:39:50,756 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 17:39:50,757 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 17:39:50,757 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 17:39:50,757 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 17:39:50,763 - app.main - INFO - Saved ir-dc4516 to DeviceDiscovery table
2025-10-07 17:39:53,378 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 17:39:53,378 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 17:39:56,450 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 17:39:56,450 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 17:39:59,522 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 17:39:59,522 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 17:40:02,594 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 17:40:02,594 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 17:40:02,693 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 17:40:02,693 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 17:40:05,794 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 17:40:05,794 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 17:40:08,866 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 17:40:08,866 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 17:40:11,938 - app.services.esphome_client - ERROR - Failed to connect to ir-dcf89f: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 17:40:11,938 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 17:40:12,862 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: The connection dropped immediately after encrypted hello; Try enabling encryption on the device or turning off encryption on the client (aioesphomeapi).
2025-10-07 17:40:12,862 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: 192.168.101.146: Connection closed
2025-10-07 17:40:14,678 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dcf89f
2025-10-07 17:40:14,689 - app.services.device_health - INFO - Found device ir-dcf89f at new IP: 192.168.101.146
2025-10-07 17:40:15,970 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.147', 6053): [Errno 113] Connect call failed ('192.168.101.147', 6053)
2025-10-07 17:40:19,042 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.148', 6053): [Errno 113] Connect call failed ('192.168.101.148', 6053)
2025-10-07 17:40:22,114 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.149', 6053): [Errno 113] Connect call failed ('192.168.101.149', 6053)
2025-10-07 17:40:25,186 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.150', 6053): [Errno 113] Connect call failed ('192.168.101.150', 6053)
2025-10-07 17:40:28,258 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.151', 6053): [Errno 113] Connect call failed ('192.168.101.151', 6053)
2025-10-07 17:40:31,330 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.152', 6053): [Errno 113] Connect call failed ('192.168.101.152', 6053)
2025-10-07 17:40:31,331 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.153', 6053): [Errno 111] Connect call failed ('192.168.101.153', 6053)
2025-10-07 17:40:34,402 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.154', 6053): [Errno 113] Connect call failed ('192.168.101.154', 6053)
2025-10-07 17:40:44,402 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error while starting connection: Starting connection cancelled
2025-10-07 17:40:47,458 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.156', 6053): [Errno 113] Connect call failed ('192.168.101.156', 6053)
2025-10-07 17:41:01,477 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: [Errno 104] Connection reset by peer
2025-10-07 17:41:01,478 - app.services.esphome_client - ERROR - Error retrieving capabilities from ir-dcf89f: Read failed
2025-10-07 17:41:01,478 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dcf89f
2025-10-07 17:41:01,665 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 17:41:01,667 - app.services.device_health - ERROR - Error during health check: UPDATE statement on table 'managed_devices' expected to update 1 row(s); 0 were matched.
2025-10-07 17:41:27,563 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 17:44:24,243 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 17:44:24,243 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 17:44:24,243 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 17:44:24,243 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 17:44:24,250 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 17:44:24,317 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 17:44:24,317 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 17:44:24,317 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 17:44:24,317 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 17:44:24,321 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 17:46:01,666 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 17:46:01,667 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 17:46:04,457 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 17:46:11,667 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error while finishing connection: Finishing connection cancelled
2025-10-07 17:46:11,667 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dc4516
2025-10-07 17:46:11,667 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: Connection lost
2025-10-07 17:46:14,754 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 17:46:17,826 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 17:46:18,731 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 17:46:18,732 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 17:46:18,732 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 17:46:18,732 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 17:46:18,738 - app.main - INFO - Saved ir-dc4516 to DeviceDiscovery table
2025-10-07 17:46:20,898 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 17:46:23,970 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 17:46:27,042 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 17:46:29,605 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 17:46:31,647 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 17:46:31,716 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 17:46:34,786 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 17:46:37,858 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 17:46:40,930 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
WARNING:  WatchFiles detected changes in 'app/api/device_management.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 17:46:43,268 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 17:46:43,268 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 17:46:43,268 - app.main - INFO - TV status polling service stopped
2025-10-07 17:46:43,268 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 17:46:43,269 - app.main - INFO - Device status monitoring stopped
2025-10-07 17:46:43,269 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 17:46:43,269 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 17:46:43,269 - app.main - INFO - Schedule processor stopped
2025-10-07 17:46:43,269 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 17:46:43,269 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 17:46:43,269 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 17:46:43,269 - app.main - INFO - History cleanup service stopped
2025-10-07 17:46:43,269 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 17:46:43,269 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 17:46:43,269 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 17:46:43,269 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 17:46:43,269 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 17:46:43,269 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 17:46:43,269 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 17:46:43,269 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 17:46:43,269 - app.main - INFO - Command queue processor stopped
2025-10-07 17:46:43,269 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 17:46:43,269 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error while finishing connection: Finishing connection cancelled
2025-10-07 17:46:43,269 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: Connection lost
2025-10-07 17:46:46,242 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.147', 6053): [Errno 113] Connect call failed ('192.168.101.147', 6053)
2025-10-07 17:46:49,314 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.148', 6053): [Errno 113] Connect call failed ('192.168.101.148', 6053)
2025-10-07 17:46:52,386 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.149', 6053): [Errno 113] Connect call failed ('192.168.101.149', 6053)
2025-10-07 17:46:55,458 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.150', 6053): [Errno 113] Connect call failed ('192.168.101.150', 6053)
2025-10-07 17:46:58,530 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.151', 6053): [Errno 113] Connect call failed ('192.168.101.151', 6053)
2025-10-07 17:47:01,602 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.152', 6053): [Errno 113] Connect call failed ('192.168.101.152', 6053)
2025-10-07 17:47:01,603 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.153', 6053): [Errno 111] Connect call failed ('192.168.101.153', 6053)
2025-10-07 17:47:04,674 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.154', 6053): [Errno 113] Connect call failed ('192.168.101.154', 6053)
2025-10-07 17:47:14,676 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error while starting connection: Starting connection cancelled
2025-10-07 17:47:17,730 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.156', 6053): [Errno 113] Connect call failed ('192.168.101.156', 6053)
2025-10-07 17:47:17,731 - app.main - INFO - Device health monitoring stopped
2025-10-07 17:47:17,731 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 17:47:17,731 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 17:47:17,731 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [593277]
Template seeding complete; using dynamic IR library system.
/home/coastal/smartvenue/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [594906]
INFO:     Waiting for application startup.
2025-10-07 17:47:19,381 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 17:47:19,387 - app.main - INFO - Database tables created
2025-10-07 17:47:19,409 - app.main - INFO - Database initialized with seed data
2025-10-07 17:47:19,409 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 17:47:19,410 - app.services.discovery - INFO - Device discovery started
2025-10-07 17:47:19,411 - app.main - INFO - Device discovery started
2025-10-07 17:47:19,411 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 17:47:19,411 - app.main - INFO - Device health monitoring started
2025-10-07 17:47:19,411 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 17:47:19,411 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 17:47:19,411 - app.main - INFO - Command queue processor started
2025-10-07 17:47:19,411 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 17:47:19,411 - app.main - INFO - History cleanup service started
2025-10-07 17:47:19,411 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 17:47:19,412 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 17:47:19,414 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 17:47:19,414 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 17:47:19,414 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 17:47:19,414 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 17:47:19,415 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 17:47:19,415 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 17:47:19,415 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 17:47:19,415 - app.main - INFO - Schedule processor started
2025-10-07 17:47:19,415 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 17:47:19,415 - app.main - INFO - Device status monitoring started
2025-10-07 17:47:19,415 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 17:47:19,415 - app.main - INFO - TV status polling service started
2025-10-07 17:47:19,415 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 17:47:19,421 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 17:47:19,421 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 17:47:19,422 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 9.2 hours)
2025-10-07 17:47:19,429 - app.services.device_status_checker - INFO - Checking status of 4 devices
INFO:     Application startup complete.
2025-10-07 17:47:21,614 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 17:47:21,614 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 17:47:21,614 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:47:21,614 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:47:21,623 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 17:47:21,635 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 17:47:21,636 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 17:47:21,636 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 17:47:21,636 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 17:47:21,642 - app.main - INFO - Saved loungefan to DeviceDiscovery table
2025-10-07 17:47:21,674 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 17:47:21,674 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 17:47:21,674 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 17:47:21,674 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 17:47:21,677 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 17:47:21,694 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 17:47:21,694 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 17:47:21,694 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 17:47:21,694 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 17:47:21,697 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 17:47:21,711 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 17:47:21,712 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 17:47:21,712 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 17:47:21,712 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 17:47:21,714 - app.main - INFO - Saved presence-garage to DeviceDiscovery table
2025-10-07 17:47:22,604 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 17:47:22,605 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 17:47:22,605 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 17:47:22,605 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 17:47:22,608 - app.main - INFO - Saved ir-dca09e to DeviceDiscovery table
2025-10-07 17:47:22,665 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 17:47:22,665 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 17:47:22,666 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 17:47:22,666 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 17:47:22,672 - app.main - INFO - Saved kitchen-fan to DeviceDiscovery table
2025-10-07 17:47:22,681 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 17:47:22,681 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 17:47:22,681 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 17:47:22,681 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 17:47:22,684 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
2025-10-07 17:47:22,698 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 17:47:22,698 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 17:47:22,698 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 17:47:22,698 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 17:47:22,701 - app.main - INFO - Saved waterheater to DeviceDiscovery table
2025-10-07 17:47:22,763 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 17:47:22,763 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 17:47:22,763 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 17:47:22,763 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 17:47:22,766 - app.main - INFO - Saved bt-proxy-garage to DeviceDiscovery table
2025-10-07 17:47:22,766 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 17:47:22,767 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 17:47:22,767 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 17:47:22,767 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 17:47:22,770 - app.main - INFO - Saved esp32-bluetooth-proxy-f32ccc to DeviceDiscovery table
2025-10-07 17:47:22,844 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 17:47:22,844 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 17:47:22,845 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 17:47:22,845 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 17:47:22,847 - app.main - INFO - Saved bt-proxy-office to DeviceDiscovery table
2025-10-07 17:47:25,229 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 17:47:25,230 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 17:47:25,230 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 17:47:25,230 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 17:47:25,236 - app.main - INFO - Saved ir-dc4516 to DeviceDiscovery table
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 17:47:28,199 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 17:47:28,199 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 17:47:28,199 - app.main - INFO - TV status polling service stopped
2025-10-07 17:47:28,199 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 17:47:28,199 - app.main - INFO - Device status monitoring stopped
2025-10-07 17:47:28,199 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 17:47:28,199 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 17:47:28,199 - app.main - INFO - Schedule processor stopped
2025-10-07 17:47:28,200 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 17:47:28,200 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 17:47:28,200 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 17:47:28,200 - app.main - INFO - History cleanup service stopped
2025-10-07 17:47:28,200 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 17:47:28,200 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 17:47:28,200 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 17:47:28,200 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 17:47:28,200 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 17:47:28,200 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 17:47:28,200 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 17:47:28,200 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 17:47:28,200 - app.main - INFO - Command queue processor stopped
2025-10-07 17:47:28,200 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 17:47:28,200 - app.main - INFO - Device health monitoring stopped
2025-10-07 17:47:28,200 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 17:47:28,200 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 17:47:28,200 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [594906]
Template seeding complete; using dynamic IR library system.
/home/coastal/smartvenue/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [594934]
INFO:     Waiting for application startup.
2025-10-07 17:47:29,863 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 17:47:29,868 - app.main - INFO - Database tables created
2025-10-07 17:47:29,889 - app.main - INFO - Database initialized with seed data
2025-10-07 17:47:29,889 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 17:47:29,890 - app.services.discovery - INFO - Device discovery started
2025-10-07 17:47:29,890 - app.main - INFO - Device discovery started
2025-10-07 17:47:29,890 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 17:47:29,890 - app.main - INFO - Device health monitoring started
2025-10-07 17:47:29,891 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 17:47:29,891 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 17:47:29,891 - app.main - INFO - Command queue processor started
2025-10-07 17:47:29,891 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 17:47:29,891 - app.main - INFO - History cleanup service started
2025-10-07 17:47:29,891 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 17:47:29,892 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 17:47:29,894 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 17:47:29,894 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 17:47:29,894 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 17:47:29,894 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 17:47:29,895 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 17:47:29,895 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 17:47:29,895 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 17:47:29,895 - app.main - INFO - Schedule processor started
2025-10-07 17:47:29,895 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 17:47:29,895 - app.main - INFO - Device status monitoring started
2025-10-07 17:47:29,895 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 17:47:29,895 - app.main - INFO - TV status polling service started
2025-10-07 17:47:29,895 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 17:47:29,900 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 17:47:29,900 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 17:47:29,901 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 9.2 hours)
2025-10-07 17:47:29,907 - app.services.device_status_checker - INFO - Checking status of 4 devices
INFO:     Application startup complete.
2025-10-07 17:47:31,966 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 17:47:31,967 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 17:47:31,967 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 17:47:31,967 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 17:47:31,973 - app.main - ERROR - Error saving discovered device to database: no running event loop
/home/coastal/smartvenue/backend/app/main.py:200: RuntimeWarning: coroutine 'on_device_discovered.<locals>.fetch_caps' was never awaited
  db.rollback()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-10-07 17:47:32,069 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 17:47:32,069 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 17:47:32,069 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:47:32,069 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:47:32,070 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 17:47:32,139 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 17:47:32,139 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 17:47:32,139 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 17:47:32,139 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 17:47:32,140 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 17:47:32,205 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 17:47:32,206 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 17:47:32,206 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 17:47:32,206 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 17:47:32,206 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 17:47:32,321 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 17:47:32,321 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 17:47:32,321 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 17:47:32,321 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 17:47:32,322 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 17:47:33,075 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 17:47:33,075 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 17:47:33,075 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 17:47:33,075 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 17:47:33,076 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 17:47:33,105 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 17:47:33,106 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 17:47:33,106 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 17:47:33,106 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 17:47:33,106 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 17:47:33,111 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 17:47:33,111 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 17:47:33,111 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 17:47:33,111 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 17:47:33,112 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 17:47:33,117 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 17:47:33,117 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 17:47:33,117 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 17:47:33,117 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 17:47:33,118 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 17:47:33,201 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 17:47:33,201 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 17:47:33,201 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 17:47:33,201 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 17:47:33,202 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 17:47:33,218 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 17:47:33,218 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 17:47:33,218 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 17:47:33,218 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 17:47:33,219 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 17:47:33,291 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 17:47:33,291 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 17:47:33,291 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 17:47:33,291 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 17:47:33,292 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 17:47:37,254 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 17:47:37,254 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 17:47:37,254 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 17:47:37,254 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 17:47:37,255 - app.main - ERROR - Error saving discovered device to database: no running event loop
WARNING:  WatchFiles detected changes in 'app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 17:48:12,834 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 17:48:12,834 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 17:48:12,834 - app.main - INFO - TV status polling service stopped
2025-10-07 17:48:12,834 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 17:48:12,834 - app.main - INFO - Device status monitoring stopped
2025-10-07 17:48:12,834 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 17:48:12,834 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 17:48:12,834 - app.main - INFO - Schedule processor stopped
2025-10-07 17:48:12,834 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 17:48:12,834 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 17:48:12,834 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 17:48:12,834 - app.main - INFO - History cleanup service stopped
2025-10-07 17:48:12,835 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 17:48:12,835 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 17:48:12,835 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 17:48:12,835 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 17:48:12,835 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 17:48:12,835 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 17:48:12,835 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 17:48:12,835 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 17:48:12,835 - app.main - INFO - Command queue processor stopped
2025-10-07 17:48:12,835 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 17:48:12,835 - app.main - INFO - Device health monitoring stopped
2025-10-07 17:48:12,835 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 17:48:12,835 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 17:48:12,835 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [594934]
Template seeding complete; using dynamic IR library system.
/home/coastal/smartvenue/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [594962]
INFO:     Waiting for application startup.
2025-10-07 17:48:14,476 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 17:48:14,482 - app.main - INFO - Database tables created
2025-10-07 17:48:14,504 - app.main - INFO - Database initialized with seed data
2025-10-07 17:48:14,504 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 17:48:14,505 - app.services.discovery - INFO - Device discovery started
2025-10-07 17:48:14,505 - app.main - INFO - Device discovery started
2025-10-07 17:48:14,505 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 17:48:14,505 - app.main - INFO - Device health monitoring started
2025-10-07 17:48:14,505 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 17:48:14,506 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 17:48:14,506 - app.main - INFO - Command queue processor started
2025-10-07 17:48:14,506 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 17:48:14,506 - app.main - INFO - History cleanup service started
2025-10-07 17:48:14,506 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 17:48:14,507 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 17:48:14,509 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 17:48:14,509 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 17:48:14,509 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 17:48:14,509 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 17:48:14,509 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 17:48:14,509 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 17:48:14,510 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 17:48:14,510 - app.main - INFO - Schedule processor started
2025-10-07 17:48:14,510 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 17:48:14,510 - app.main - INFO - Device status monitoring started
2025-10-07 17:48:14,510 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 17:48:14,510 - app.main - INFO - TV status polling service started
2025-10-07 17:48:14,510 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 17:48:14,515 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 17:48:14,516 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 17:48:14,516 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 9.2 hours)
2025-10-07 17:48:14,523 - app.services.device_status_checker - INFO - Checking status of 4 devices
INFO:     Application startup complete.
2025-10-07 17:48:16,642 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 17:48:16,642 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 17:48:16,642 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 17:48:16,642 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 17:48:16,647 - app.main - ERROR - Error saving discovered device to database: no running event loop
/home/coastal/smartvenue/backend/app/main.py:200: RuntimeWarning: coroutine 'on_device_discovered.<locals>.fetch_caps' was never awaited
  db.rollback()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-10-07 17:48:16,669 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 17:48:16,670 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 17:48:16,670 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:48:16,670 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:48:16,673 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 17:48:16,690 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 17:48:16,691 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 17:48:16,691 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 17:48:16,691 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 17:48:16,694 - app.main - INFO - Saved loungefan to DeviceDiscovery table
2025-10-07 17:48:16,709 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 17:48:16,709 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 17:48:16,710 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 17:48:16,710 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 17:48:16,712 - app.main - INFO - Saved presence-garage to DeviceDiscovery table
2025-10-07 17:48:16,753 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 17:48:16,753 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 17:48:16,754 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 17:48:16,754 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 17:48:16,758 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 17:48:16,773 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 17:48:16,773 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 17:48:16,773 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 17:48:16,773 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 17:48:16,776 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 17:48:17,639 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 17:48:17,640 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 17:48:17,640 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 17:48:17,640 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 17:48:17,640 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 17:48:17,718 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 17:48:17,719 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 17:48:17,719 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 17:48:17,719 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 17:48:17,722 - app.main - INFO - Saved kitchen-fan to DeviceDiscovery table
2025-10-07 17:48:17,732 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 17:48:17,732 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 17:48:17,732 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 17:48:17,732 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 17:48:17,735 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
2025-10-07 17:48:17,798 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 17:48:17,798 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 17:48:17,798 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 17:48:17,798 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 17:48:17,801 - app.main - INFO - Saved waterheater to DeviceDiscovery table
2025-10-07 17:48:17,845 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 17:48:17,845 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 17:48:17,845 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 17:48:17,845 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 17:48:17,848 - app.main - INFO - Saved bt-proxy-garage to DeviceDiscovery table
2025-10-07 17:48:17,857 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 17:48:17,857 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 17:48:17,857 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 17:48:17,857 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 17:48:17,860 - app.main - INFO - Saved esp32-bluetooth-proxy-f32ccc to DeviceDiscovery table
2025-10-07 17:48:17,880 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 17:48:17,880 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 17:48:17,880 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 17:48:17,880 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 17:48:17,883 - app.main - INFO - Saved bt-proxy-office to DeviceDiscovery table
WARNING:  WatchFiles detected changes in 'app/api/device_management.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 17:48:21,287 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 17:48:21,287 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 17:48:21,287 - app.main - INFO - TV status polling service stopped
2025-10-07 17:48:21,287 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 17:48:21,287 - app.main - INFO - Device status monitoring stopped
2025-10-07 17:48:21,287 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 17:48:21,287 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 17:48:21,287 - app.main - INFO - Schedule processor stopped
2025-10-07 17:48:21,287 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 17:48:21,287 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 17:48:21,287 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 17:48:21,287 - app.main - INFO - History cleanup service stopped
2025-10-07 17:48:21,287 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 17:48:21,287 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 17:48:21,287 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 17:48:21,287 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 17:48:21,287 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 17:48:21,288 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 17:48:21,288 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 17:48:21,288 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 17:48:21,288 - app.main - INFO - Command queue processor stopped
2025-10-07 17:48:21,288 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 17:48:21,288 - app.main - INFO - Device health monitoring stopped
2025-10-07 17:48:21,288 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 17:48:21,288 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 17:48:21,288 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [594962]
Template seeding complete; using dynamic IR library system.
/home/coastal/smartvenue/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [594986]
INFO:     Waiting for application startup.
2025-10-07 17:48:22,951 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 17:48:22,957 - app.main - INFO - Database tables created
2025-10-07 17:48:22,978 - app.main - INFO - Database initialized with seed data
2025-10-07 17:48:22,978 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 17:48:22,979 - app.services.discovery - INFO - Device discovery started
2025-10-07 17:48:22,979 - app.main - INFO - Device discovery started
2025-10-07 17:48:22,979 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 17:48:22,979 - app.main - INFO - Device health monitoring started
2025-10-07 17:48:22,979 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 17:48:22,979 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 17:48:22,979 - app.main - INFO - Command queue processor started
2025-10-07 17:48:22,980 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 17:48:22,980 - app.main - INFO - History cleanup service started
2025-10-07 17:48:22,980 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 17:48:22,981 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 17:48:22,982 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 17:48:22,982 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 17:48:22,982 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 17:48:22,982 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 17:48:22,983 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 17:48:22,983 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 17:48:22,983 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 17:48:22,983 - app.main - INFO - Schedule processor started
2025-10-07 17:48:22,983 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 17:48:22,983 - app.main - INFO - Device status monitoring started
2025-10-07 17:48:22,983 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 17:48:22,983 - app.main - INFO - TV status polling service started
2025-10-07 17:48:22,983 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 17:48:22,988 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 17:48:22,988 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 17:48:22,989 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 9.2 hours)
2025-10-07 17:48:22,995 - app.services.device_status_checker - INFO - Checking status of 4 devices
INFO:     Application startup complete.
2025-10-07 17:48:25,053 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 17:48:25,053 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 17:48:25,054 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 17:48:25,054 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 17:48:25,059 - app.main - ERROR - Error saving discovered device to database: no running event loop
/home/coastal/smartvenue/backend/app/main.py:200: RuntimeWarning: coroutine 'on_device_discovered.<locals>.fetch_caps' was never awaited
  db.rollback()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-10-07 17:48:25,087 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 17:48:25,087 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 17:48:25,088 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 17:48:25,088 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 17:48:25,092 - app.main - INFO - Saved kitchen-fan to DeviceDiscovery table
2025-10-07 17:48:25,111 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 17:48:25,112 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 17:48:25,112 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 17:48:25,112 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 17:48:25,115 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
2025-10-07 17:48:25,145 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 17:48:25,145 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 17:48:25,145 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 17:48:25,145 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 17:48:25,148 - app.main - INFO - Saved bt-proxy-office to DeviceDiscovery table
2025-10-07 17:48:25,185 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 17:48:25,185 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 17:48:25,185 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 17:48:25,185 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 17:48:25,192 - app.main - INFO - Saved esp32-bluetooth-proxy-f32ccc to DeviceDiscovery table
2025-10-07 17:48:25,201 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 17:48:25,201 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 17:48:25,201 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 17:48:25,201 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 17:48:25,204 - app.main - INFO - Saved waterheater to DeviceDiscovery table
2025-10-07 17:48:25,273 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 17:48:25,273 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 17:48:25,273 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 17:48:25,273 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 17:48:25,276 - app.main - INFO - Saved bt-proxy-garage to DeviceDiscovery table
2025-10-07 17:48:26,127 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 17:48:26,127 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 17:48:26,127 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 17:48:26,127 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 17:48:26,131 - app.main - INFO - Saved loungefan to DeviceDiscovery table
2025-10-07 17:48:26,149 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 17:48:26,149 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 17:48:26,149 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 17:48:26,149 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 17:48:26,152 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 17:48:26,174 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 17:48:26,174 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 17:48:26,174 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:48:26,174 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 17:48:26,178 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 17:48:26,184 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 17:48:26,184 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 17:48:26,184 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 17:48:26,184 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 17:48:26,190 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 17:48:39,210 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 17:48:39,211 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 17:48:39,211 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 17:48:39,211 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 17:48:39,214 - app.main - INFO - Saved presence-garage to DeviceDiscovery table
2025-10-07 17:48:40,103 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 17:48:40,103 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 17:48:40,103 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 17:48:40,103 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 17:48:40,104 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 17:53:22,983 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 17:53:22,985 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 17:53:25,050 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 17:53:27,113 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 17:53:32,988 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error while finishing connection: Finishing connection cancelled
2025-10-07 17:53:32,988 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dc4516
2025-10-07 17:53:32,988 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: Connection lost
2025-10-07 17:53:35,970 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 17:53:39,042 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 17:53:42,115 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 17:53:45,186 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 17:53:48,258 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 17:53:51,330 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 17:53:51,334 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 17:53:54,402 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 17:53:57,474 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 17:54:00,546 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 17:54:03,504 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dc4516
2025-10-07 17:54:03,519 - app.services.device_health - INFO - Found device ir-dc4516 at new IP: 192.168.101.146
2025-10-07 17:54:03,751 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 17:54:03,984 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dc4516
2025-10-07 17:54:03,989 - app.services.device_health - INFO - Health check complete: 2/2 devices online
2025-10-07 17:56:02,454 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 17:56:02,455 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 17:56:02,455 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 17:56:02,455 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 17:56:02,455 - app.main - ERROR - Error saving discovered device to database: no running event loop
/home/coastal/smartvenue/backend/app/main.py:200: RuntimeWarning: coroutine 'on_device_discovered.<locals>.fetch_caps' was never awaited
  db.rollback()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-10-07 17:58:27,093 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 17:59:03,990 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 17:59:03,990 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 17:59:06,933 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 17:59:07,127 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 17:59:07,133 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 17:59:28,824 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 17:59:28,824 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 17:59:28,824 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 17:59:28,825 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 17:59:28,831 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
2025-10-07 18:02:21,578 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 18:02:21,579 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 18:02:21,579 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 18:02:21,579 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 18:02:21,583 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 18:02:21,591 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 18:02:21,591 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 18:02:21,591 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 18:02:21,591 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 18:02:21,597 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 18:02:48,350 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 18:02:48,350 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 18:02:48,350 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 18:02:48,350 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 18:02:48,351 - app.main - ERROR - Error saving discovered device to database: no running event loop
/home/coastal/smartvenue/backend/app/main.py:200: RuntimeWarning: coroutine 'on_device_discovered.<locals>.fetch_caps' was never awaited
  db.rollback()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-10-07 18:03:29,135 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 18:04:07,133 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 18:04:07,134 - app.services.device_health - INFO - Checking health of 1 managed devices
2025-10-07 18:04:09,883 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 18:04:10,084 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 18:04:10,088 - app.services.device_health - INFO - Health check complete: 1/1 devices online
2025-10-07 18:08:31,184 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 18:09:10,087 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 18:09:10,088 - app.services.device_health - INFO - Checking health of 2 managed devices
WARNING:  WatchFiles detected changes in 'app/routers/network_tv.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 18:09:10,696 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 18:09:10,696 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 18:09:10,696 - app.main - INFO - TV status polling service stopped
2025-10-07 18:09:10,696 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 18:09:10,696 - app.main - INFO - Device status monitoring stopped
2025-10-07 18:09:10,696 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 18:09:10,696 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 18:09:10,696 - app.main - INFO - Schedule processor stopped
2025-10-07 18:09:10,697 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 18:09:10,697 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 18:09:10,697 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 18:09:10,697 - app.main - INFO - History cleanup service stopped
2025-10-07 18:09:10,697 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 18:09:10,697 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 18:09:10,697 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 18:09:10,697 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 18:09:10,697 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 18:09:10,697 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 18:09:10,697 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 18:09:10,697 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 18:09:10,697 - app.main - INFO - Command queue processor stopped
2025-10-07 18:09:10,697 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 18:09:10,697 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error while finishing connection: Finishing connection cancelled
2025-10-07 18:09:10,697 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dca09e
2025-10-07 18:09:10,697 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error while finishing connection: Finishing connection cancelled
2025-10-07 18:09:10,697 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dc4516
2025-10-07 18:09:10,698 - aioesphomeapi.connection - WARNING - 192.168.101.132: Connection error occurred: 192.168.101.132: Connection lost
2025-10-07 18:09:10,698 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: Connection lost
2025-10-07 18:09:10,811 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.122', 6053): [Errno 111] Connect call failed ('192.168.101.122', 6053)
2025-10-07 18:09:13,762 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 18:09:13,890 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.123', 6053): [Errno 113] Connect call failed ('192.168.101.123', 6053)
2025-10-07 18:09:16,834 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 18:09:16,962 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.124', 6053): [Errno 113] Connect call failed ('192.168.101.124', 6053)
2025-10-07 18:09:19,906 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 18:09:22,978 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 18:09:26,050 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 18:09:26,963 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error while starting connection: Starting connection cancelled
2025-10-07 18:09:29,122 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 18:09:29,223 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 18:09:30,018 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.126', 6053): [Errno 113] Connect call failed ('192.168.101.126', 6053)
2025-10-07 18:09:32,322 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 18:09:33,090 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.127', 6053): [Errno 113] Connect call failed ('192.168.101.127', 6053)
2025-10-07 18:09:33,092 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.128', 6053): [Errno 111] Connect call failed ('192.168.101.128', 6053)
2025-10-07 18:09:35,394 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 18:09:36,162 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.129', 6053): [Errno 113] Connect call failed ('192.168.101.129', 6053)
2025-10-07 18:09:38,466 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 18:09:46,164 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error while starting connection: Starting connection cancelled
2025-10-07 18:09:48,467 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error while starting connection: Starting connection cancelled
2025-10-07 18:09:49,218 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.131', 6053): [Errno 113] Connect call failed ('192.168.101.131', 6053)
2025-10-07 18:09:51,522 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.147', 6053): [Errno 113] Connect call failed ('192.168.101.147', 6053)
2025-10-07 18:09:52,022 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 18:09:52,048 - app.services.device_health - INFO - Found device ir-dca09e at new IP: 192.168.101.132
2025-10-07 18:09:54,594 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.148', 6053): [Errno 113] Connect call failed ('192.168.101.148', 6053)
2025-10-07 18:09:57,666 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.149', 6053): [Errno 113] Connect call failed ('192.168.101.149', 6053)
2025-10-07 18:10:00,738 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.150', 6053): [Errno 113] Connect call failed ('192.168.101.150', 6053)
2025-10-07 18:10:03,810 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.151', 6053): [Errno 113] Connect call failed ('192.168.101.151', 6053)
2025-10-07 18:10:06,882 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.152', 6053): [Errno 113] Connect call failed ('192.168.101.152', 6053)
2025-10-07 18:10:06,883 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.153', 6053): [Errno 111] Connect call failed ('192.168.101.153', 6053)
2025-10-07 18:10:09,954 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.154', 6053): [Errno 113] Connect call failed ('192.168.101.154', 6053)
2025-10-07 18:10:19,960 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error while starting connection: Starting connection cancelled
2025-10-07 18:10:23,010 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.156', 6053): [Errno 113] Connect call failed ('192.168.101.156', 6053)
2025-10-07 18:10:23,011 - app.main - INFO - Device health monitoring stopped
2025-10-07 18:10:23,011 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 18:10:23,011 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 18:10:23,011 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [594986]
Template seeding complete; using dynamic IR library system.
WARNING:  WatchFiles detected changes in 'app/routers/network_tv.py'. Reloading...
/home/coastal/smartvenue/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [595898]
INFO:     Waiting for application startup.
2025-10-07 18:10:24,962 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 18:10:24,968 - app.main - INFO - Database tables created
2025-10-07 18:10:24,989 - app.main - INFO - Database initialized with seed data
2025-10-07 18:10:24,989 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 18:10:24,991 - app.services.discovery - INFO - Device discovery started
2025-10-07 18:10:24,991 - app.main - INFO - Device discovery started
2025-10-07 18:10:24,991 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 18:10:24,991 - app.main - INFO - Device health monitoring started
2025-10-07 18:10:24,991 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 18:10:24,991 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 18:10:24,991 - app.main - INFO - Command queue processor started
2025-10-07 18:10:24,991 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 18:10:24,991 - app.main - INFO - History cleanup service started
2025-10-07 18:10:24,991 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 18:10:24,992 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 18:10:24,994 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 18:10:24,994 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 18:10:24,994 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 18:10:24,995 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 18:10:24,995 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 18:10:24,995 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 18:10:24,995 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 18:10:24,995 - app.main - INFO - Schedule processor started
2025-10-07 18:10:24,995 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 18:10:24,995 - app.main - INFO - Device status monitoring started
2025-10-07 18:10:24,995 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 18:10:24,996 - app.main - INFO - TV status polling service started
2025-10-07 18:10:24,996 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 18:10:25,001 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 18:10:25,002 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 18:10:25,002 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 8.8 hours)
2025-10-07 18:10:25,009 - app.services.device_status_checker - INFO - Checking status of 3 devices
INFO:     Application startup complete.
2025-10-07 18:10:27,097 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 18:10:27,098 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 18:10:27,098 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 18:10:27,098 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 18:10:27,103 - app.main - ERROR - Error saving discovered device to database: no running event loop
/home/coastal/smartvenue/backend/app/main.py:200: RuntimeWarning: coroutine 'on_device_discovered.<locals>.fetch_caps' was never awaited
  db.rollback()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-10-07 18:10:27,113 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 18:10:27,113 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 18:10:27,113 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:10:27,113 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:10:27,118 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 18:10:27,251 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 18:10:27,251 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 18:10:27,252 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 18:10:27,252 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 18:10:27,255 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 18:10:27,262 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 18:10:27,263 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 18:10:27,263 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 18:10:27,263 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 18:10:27,266 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 18:10:27,302 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 18:10:27,302 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 18:10:27,302 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 18:10:27,302 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 18:10:27,306 - app.main - INFO - Saved presence-garage to DeviceDiscovery table
2025-10-07 18:10:27,683 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 18:10:27,684 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 18:10:27,684 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 18:10:27,684 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 18:10:27,687 - app.main - INFO - Saved loungefan to DeviceDiscovery table
2025-10-07 18:10:28,097 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 18:10:28,097 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 18:10:28,097 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 18:10:28,097 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 18:10:28,098 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 18:10:28,149 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 18:10:28,149 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 18:10:28,149 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 18:10:28,149 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 18:10:28,152 - app.main - INFO - Saved kitchen-fan to DeviceDiscovery table
2025-10-07 18:10:28,294 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 18:10:28,294 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 18:10:28,294 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 18:10:28,294 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 18:10:28,300 - app.main - INFO - Saved waterheater to DeviceDiscovery table
2025-10-07 18:10:28,575 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 18:10:28,575 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 18:10:28,575 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 18:10:28,575 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 18:10:28,578 - app.main - INFO - Saved bt-proxy-garage to DeviceDiscovery table
2025-10-07 18:10:32,274 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 18:10:32,275 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 18:10:32,275 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 18:10:32,275 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 18:10:32,278 - app.main - INFO - Saved esp32-bluetooth-proxy-f32ccc to DeviceDiscovery table
2025-10-07 18:10:41,236 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 18:10:41,237 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 18:10:41,237 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 18:10:41,237 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 18:10:41,240 - app.main - INFO - Saved bt-proxy-office to DeviceDiscovery table
WARNING:  WatchFiles detected changes in 'app/routers/network_tv.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 18:13:15,924 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 18:13:15,924 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 18:13:15,924 - app.main - INFO - TV status polling service stopped
2025-10-07 18:13:15,924 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 18:13:15,924 - app.main - INFO - Device status monitoring stopped
2025-10-07 18:13:15,924 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 18:13:15,925 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 18:13:15,925 - app.main - INFO - Schedule processor stopped
2025-10-07 18:13:15,925 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 18:13:15,925 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 18:13:15,925 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 18:13:15,925 - app.main - INFO - History cleanup service stopped
2025-10-07 18:13:15,925 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 18:13:15,925 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 18:13:15,925 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 18:13:15,925 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 18:13:15,925 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 18:13:15,925 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 18:13:15,925 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 18:13:15,925 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 18:13:15,925 - app.main - INFO - Command queue processor stopped
2025-10-07 18:13:15,925 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 18:13:15,925 - app.main - INFO - Device health monitoring stopped
2025-10-07 18:13:15,925 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 18:13:15,925 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 18:13:15,925 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [595898]
Template seeding complete; using dynamic IR library system.
/home/coastal/smartvenue/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [596036]
INFO:     Waiting for application startup.
2025-10-07 18:13:17,574 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 18:13:17,580 - app.main - INFO - Database tables created
2025-10-07 18:13:17,601 - app.main - INFO - Database initialized with seed data
2025-10-07 18:13:17,601 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 18:13:17,602 - app.services.discovery - INFO - Device discovery started
2025-10-07 18:13:17,602 - app.main - INFO - Device discovery started
2025-10-07 18:13:17,602 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 18:13:17,602 - app.main - INFO - Device health monitoring started
2025-10-07 18:13:17,602 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 18:13:17,602 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 18:13:17,602 - app.main - INFO - Command queue processor started
2025-10-07 18:13:17,602 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 18:13:17,602 - app.main - INFO - History cleanup service started
2025-10-07 18:13:17,603 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 18:13:17,604 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 18:13:17,605 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 18:13:17,606 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 18:13:17,606 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 18:13:17,606 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 18:13:17,606 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 18:13:17,606 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 18:13:17,606 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 18:13:17,606 - app.main - INFO - Schedule processor started
2025-10-07 18:13:17,606 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 18:13:17,607 - app.main - INFO - Device status monitoring started
2025-10-07 18:13:17,607 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 18:13:17,607 - app.main - INFO - TV status polling service started
2025-10-07 18:13:17,607 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 18:13:17,611 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 18:13:17,612 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 18:13:17,613 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 8.8 hours)
2025-10-07 18:13:17,619 - app.services.device_status_checker - INFO - Checking status of 4 devices
INFO:     Application startup complete.
2025-10-07 18:13:19,751 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 18:13:19,751 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 18:13:19,751 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:13:19,751 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:13:19,760 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 18:13:19,774 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 18:13:19,774 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 18:13:19,774 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 18:13:19,774 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 18:13:19,777 - app.main - INFO - Saved loungefan to DeviceDiscovery table
2025-10-07 18:13:19,796 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 18:13:19,796 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 18:13:19,796 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 18:13:19,796 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 18:13:19,803 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 18:13:19,803 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 18:13:19,803 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 18:13:19,804 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 18:13:19,804 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 18:13:19,806 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 18:13:19,936 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 18:13:19,937 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 18:13:19,937 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 18:13:19,937 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 18:13:19,940 - app.main - INFO - Saved presence-garage to DeviceDiscovery table
2025-10-07 18:13:20,715 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 18:13:20,715 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 18:13:20,715 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 18:13:20,715 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 18:13:20,716 - app.main - ERROR - Error saving discovered device to database: no running event loop
/home/coastal/smartvenue/backend/app/main.py:200: RuntimeWarning: coroutine 'on_device_discovered.<locals>.fetch_caps' was never awaited
  db.rollback()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-10-07 18:13:20,803 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 18:13:20,803 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 18:13:20,803 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 18:13:20,803 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 18:13:20,806 - app.main - INFO - Saved kitchen-fan to DeviceDiscovery table
2025-10-07 18:13:20,817 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 18:13:20,817 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 18:13:20,817 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 18:13:20,817 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 18:13:20,820 - app.main - INFO - Saved bt-proxy-office to DeviceDiscovery table
2025-10-07 18:13:20,841 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 18:13:20,841 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 18:13:20,841 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 18:13:20,842 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 18:13:20,845 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
2025-10-07 18:13:20,879 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 18:13:20,880 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 18:13:20,880 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 18:13:20,880 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 18:13:20,883 - app.main - INFO - Saved waterheater to DeviceDiscovery table
2025-10-07 18:13:20,888 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 18:13:20,888 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 18:13:20,888 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 18:13:20,888 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 18:13:20,891 - app.main - INFO - Saved esp32-bluetooth-proxy-f32ccc to DeviceDiscovery table
2025-10-07 18:13:20,928 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 18:13:20,928 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 18:13:20,928 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 18:13:20,928 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 18:13:20,931 - app.main - INFO - Saved bt-proxy-garage to DeviceDiscovery table
WARNING:  WatchFiles detected changes in 'app/routers/network_tv.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 18:13:22,083 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 18:13:22,084 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 18:13:22,084 - app.main - INFO - TV status polling service stopped
2025-10-07 18:13:22,084 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 18:13:22,084 - app.main - INFO - Device status monitoring stopped
2025-10-07 18:13:22,084 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 18:13:22,084 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 18:13:22,084 - app.main - INFO - Schedule processor stopped
2025-10-07 18:13:22,084 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 18:13:22,084 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 18:13:22,084 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 18:13:22,084 - app.main - INFO - History cleanup service stopped
2025-10-07 18:13:22,084 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 18:13:22,084 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 18:13:22,084 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 18:13:22,084 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 18:13:22,084 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 18:13:22,084 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 18:13:22,084 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 18:13:22,084 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 18:13:22,084 - app.main - INFO - Command queue processor stopped
2025-10-07 18:13:22,084 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 18:13:22,084 - app.main - INFO - Device health monitoring stopped
2025-10-07 18:13:22,084 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 18:13:22,085 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 18:13:22,085 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [596036]
Template seeding complete; using dynamic IR library system.
/home/coastal/smartvenue/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [596062]
INFO:     Waiting for application startup.
2025-10-07 18:13:23,708 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 18:13:23,713 - app.main - INFO - Database tables created
2025-10-07 18:13:23,734 - app.main - INFO - Database initialized with seed data
2025-10-07 18:13:23,735 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 18:13:23,736 - app.services.discovery - INFO - Device discovery started
2025-10-07 18:13:23,736 - app.main - INFO - Device discovery started
2025-10-07 18:13:23,736 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 18:13:23,736 - app.main - INFO - Device health monitoring started
2025-10-07 18:13:23,736 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 18:13:23,736 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 18:13:23,736 - app.main - INFO - Command queue processor started
2025-10-07 18:13:23,736 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 18:13:23,736 - app.main - INFO - History cleanup service started
2025-10-07 18:13:23,736 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 18:13:23,737 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 18:13:23,738 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 18:13:23,739 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 18:13:23,739 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 18:13:23,739 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 18:13:23,739 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 18:13:23,739 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 18:13:23,739 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 18:13:23,739 - app.main - INFO - Schedule processor started
2025-10-07 18:13:23,739 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 18:13:23,739 - app.main - INFO - Device status monitoring started
2025-10-07 18:13:23,739 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 18:13:23,739 - app.main - INFO - TV status polling service started
2025-10-07 18:13:23,740 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 18:13:23,744 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 18:13:23,744 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 18:13:23,745 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 8.8 hours)
2025-10-07 18:13:23,751 - app.services.device_status_checker - INFO - Checking status of 4 devices
INFO:     Application startup complete.
2025-10-07 18:13:25,809 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 18:13:25,809 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 18:13:25,809 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 18:13:25,809 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 18:13:25,814 - app.main - ERROR - Error saving discovered device to database: no running event loop
/home/coastal/smartvenue/backend/app/main.py:200: RuntimeWarning: coroutine 'on_device_discovered.<locals>.fetch_caps' was never awaited
  db.rollback()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-10-07 18:13:25,899 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 18:13:25,899 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 18:13:25,899 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 18:13:25,900 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 18:13:25,906 - app.main - INFO - Saved kitchen-fan to DeviceDiscovery table
2025-10-07 18:13:25,918 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 18:13:25,918 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 18:13:25,918 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 18:13:25,918 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 18:13:25,921 - app.main - INFO - Saved bt-proxy-office to DeviceDiscovery table
2025-10-07 18:13:26,020 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 18:13:26,021 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 18:13:26,021 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 18:13:26,021 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 18:13:26,024 - app.main - INFO - Saved esp32-bluetooth-proxy-f32ccc to DeviceDiscovery table
2025-10-07 18:13:26,900 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 18:13:26,901 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 18:13:26,901 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:13:26,901 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:13:26,904 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 18:13:26,986 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 18:13:26,986 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 18:13:26,986 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 18:13:26,986 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 18:13:26,989 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 18:13:27,049 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 18:13:27,049 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 18:13:27,049 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 18:13:27,049 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 18:13:27,052 - app.main - INFO - Saved loungefan to DeviceDiscovery table
2025-10-07 18:13:27,067 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 18:13:27,067 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 18:13:27,067 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 18:13:27,067 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 18:13:27,070 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 18:13:30,978 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 18:13:30,978 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 18:13:30,978 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 18:13:30,978 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 18:13:30,981 - app.main - INFO - Saved waterheater to DeviceDiscovery table
2025-10-07 18:13:31,048 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 18:13:31,048 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 18:13:31,048 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 18:13:31,048 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 18:13:31,055 - app.main - INFO - Saved bt-proxy-garage to DeviceDiscovery table
2025-10-07 18:13:34,301 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 18:13:34,302 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 18:13:34,302 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 18:13:34,302 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 18:13:34,303 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 18:13:39,992 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 18:13:39,993 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 18:13:39,993 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 18:13:39,993 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 18:13:39,996 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
2025-10-07 18:15:19,444 - app.services.queue_processor - INFO - Worker 0 executing command 12: volume_down on ir-dc4516 port 1 (attempt 1)
2025-10-07 18:15:21,900 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dc4516
2025-10-07 18:15:22,049 - app.services.esphome_client - INFO - Called service 'tv_volume_down' on ir-dc4516 with data: {'port': 1}
2025-10-07 18:15:22,055 - app.services.queue_processor - INFO - ‚úì Worker 0 completed command 12 in 2602ms
2025-10-07 18:15:35,574 - app.services.queue_processor - INFO - Worker 0 executing command 15: power_on on ir-dc4516 port 1 (attempt 1)
2025-10-07 18:15:35,724 - app.services.esphome_client - INFO - Called service 'tv_power_on' on ir-dc4516 with data: {'port': 1}
2025-10-07 18:15:35,730 - app.services.queue_processor - INFO - ‚úì Worker 0 completed command 15 in 150ms
2025-10-07 18:16:03,559 - aioesphomeapi.connection - WARNING - ir-dc4516 @ 192.168.101.146: Connection error occurred: [Errno 104] Connection reset by peer
2025-10-07 18:17:42,971 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 18:17:42,971 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 18:17:42,971 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:17:42,971 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:17:42,975 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:56172 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:56172 - "GET /api/v1/settings/app?include_private=true HTTP/1.1" 200 OK
INFO:     100.98.57.42:49225 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:49225 - "OPTIONS /api/v1/management/managed/4 HTTP/1.1" 200 OK
2025-10-07 17:51:46,574 - app.services.discovery - INFO - Marking device ir-dc4516 as unadopted - will be available for re-adoption
INFO:     100.98.57.42:49225 - "DELETE /api/v1/management/managed/4 HTTP/1.1" 200 OK
INFO:     100.98.57.42:49225 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:56172 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:49225 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     127.0.0.1:54312 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:54328 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:54312 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:54328 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     100.98.57.42:64229 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:64229 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:49378 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:50472 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:64229 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:56327 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:64408 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:56311 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:56311 - "GET /api/v1/ir-libraries/filters HTTP/1.1" 200 OK
INFO:     100.98.57.42:49463 - "GET /api/v1/ir-libraries?page=1&page_size=25&include_hidden=true HTTP/1.1" 200 OK
INFO:     100.98.57.42:49463 - "GET /api/v1/ir-capture/sessions HTTP/1.1" 200 OK
INFO:     100.98.57.42:62873 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:50708 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:61590 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:61693 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:62873 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:53865 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:53865 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:60616 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:58655 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:61286 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:61108 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:51441 - "OPTIONS /api/v1/management/manage/ir-dc4516 HTTP/1.1" 200 OK
2025-10-07 17:53:13,440 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dc4516
2025-10-07 17:53:13,636 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dc4516
INFO:     100.98.57.42:51441 - "POST /api/v1/management/manage/ir-dc4516 HTTP/1.1" 200 OK
INFO:     100.98.57.42:51441 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:55937 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:55937 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:51441 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:54107 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:51596 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:52223 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:62192 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:55937 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:52223 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
2025-10-07 17:53:22,903 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 17:53:22,903 - app.services.device_health - INFO - Checking health of 2 managed devices
2025-10-07 17:53:24,971 - app.services.device_status_checker - INFO - Checking status of 4 devices
2025-10-07 17:53:27,040 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 17:53:32,904 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error while finishing connection: Finishing connection cancelled
2025-10-07 17:53:32,904 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dc4516
2025-10-07 17:53:32,904 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: Connection lost
2025-10-07 17:53:35,970 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 17:53:39,042 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 17:53:42,114 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 17:53:45,186 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 17:53:48,258 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 17:53:51,330 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 17:53:51,334 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 17:53:54,402 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 17:53:57,474 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 17:54:00,546 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 17:54:03,501 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dc4516
2025-10-07 17:54:03,519 - app.services.device_health - INFO - Found device ir-dc4516 at new IP: 192.168.101.146
2025-10-07 17:54:03,732 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 17:54:03,940 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dc4516
2025-10-07 17:54:03,946 - app.services.device_health - INFO - Health check complete: 2/2 devices online
INFO:     100.98.57.42:64156 - "GET /api/v1/settings/app?include_private=true HTTP/1.1" 200 OK
INFO:     100.98.57.42:63496 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:59265 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:64372 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:49957 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:57742 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:57742 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:49957 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:64372 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
INFO:     127.0.0.1:33610 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:33614 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:33610 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:33614 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     100.98.57.42:55517 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:62640 - "GET /api/v1/settings/app?include_private=true HTTP/1.1" 200 OK
INFO:     100.98.57.42:55647 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:50820 - "GET /api/v1/management/available-channels HTTP/1.1" 200 OK
INFO:     100.98.57.42:62341 - "GET /api/v1/ir-codes/libraries/1799/commands HTTP/1.1" 200 OK
2025-10-07 17:55:13,265 - app.services.discovery - INFO - Marking device ir-dc4516 as unadopted - will be available for re-adoption
INFO:     100.98.57.42:62341 - "DELETE /api/v1/management/managed/4 HTTP/1.1" 200 OK
INFO:     100.98.57.42:50820 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:62341 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:50820 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:50820 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:57693 - "POST /api/v1/devices/discovery/start HTTP/1.1" 200 OK
INFO:     100.98.57.42:57693 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:50893 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:50893 - "GET /api/v1/settings/app?include_private=true HTTP/1.1" 200 OK
INFO:     100.98.57.42:52002 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
2025-10-07 17:55:45,431 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dc4516
2025-10-07 17:55:50,553 - app.services.esphome_client - WARNING - Timed out waiting for capabilities from ir-dc4516
INFO:     100.98.57.42:63358 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
2025-10-07 17:56:00,553 - aioesphomeapi.connection - ERROR - 192.168.101.146: disconnect request failed: Timeout waiting for DisconnectResponse after 10.0s
2025-10-07 17:56:00,553 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dc4516
INFO:     100.98.57.42:50815 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
2025-10-07 17:56:02,454 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 17:56:02,455 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 17:56:02,455 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 17:56:02,455 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 17:56:02,455 - app.main - ERROR - Error saving discovered device to database: no running event loop
/home/coastal/smartvenue/backend/app/main.py:200: RuntimeWarning: coroutine 'on_device_discovered.<locals>.fetch_caps' was never awaited
  db.rollback()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
INFO:     100.98.57.42:53158 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:53158 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:49323 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:62210 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:58327 - "GET /api/v1/settings/app?include_private=true HTTP/1.1" 200 OK
INFO:     100.98.57.42:50450 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:54339 - "GET /api/v1/management/available-channels HTTP/1.1" 200 OK
INFO:     100.98.57.42:49470 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:57049 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:63227 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:53837 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:49328 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:49470 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:57049 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:56335 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:54743 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:56275 - "GET /api/v1/settings/app?include_private=true HTTP/1.1" 200 OK
INFO:     100.98.57.42:53148 - "GET /api/v1/ir-codes/libraries/1799/commands HTTP/1.1" 200 OK
2025-10-07 17:58:27,013 - app.services.device_status_checker - INFO - Checking status of 4 devices
INFO:     100.98.57.42:57244 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:57244 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
2025-10-07 17:59:01,036 - app.services.discovery - INFO - Marking device ir-dc4516 as unadopted - will be available for re-adoption
INFO:     100.98.57.42:61575 - "DELETE /api/v1/management/managed/4 HTTP/1.1" 200 OK
INFO:     100.98.57.42:61575 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:53365 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:61575 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
2025-10-07 17:59:03,946 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 17:59:03,947 - app.services.device_health - INFO - Checking health of 1 managed devices
INFO:     100.98.57.42:61575 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:53365 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:60726 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:51424 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:64596 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:65451 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
2025-10-07 17:59:06,414 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 17:59:06,611 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 17:59:06,616 - app.services.device_health - INFO - Health check complete: 1/1 devices online
INFO:     100.98.57.42:55559 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:52390 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
2025-10-07 17:59:28,824 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 17:59:28,824 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 17:59:28,825 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 17:59:28,825 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 17:59:28,828 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
INFO:     100.98.57.42:64315 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:60658 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:62251 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:53536 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:52009 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:64247 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:52707 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:61252 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:53007 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:58044 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:55614 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:49247 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:61288 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:57106 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:53723 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:55291 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:53672 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
2025-10-07 18:02:21,578 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 18:02:21,579 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 18:02:21,579 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 18:02:21,579 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 18:02:21,582 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 18:02:21,591 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 18:02:21,591 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 18:02:21,591 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 18:02:21,591 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 18:02:21,594 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
INFO:     100.98.57.42:52200 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:64072 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:64837 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
2025-10-07 18:02:48,350 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 18:02:48,350 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 18:02:48,350 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 18:02:48,350 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 18:02:48,351 - app.main - ERROR - Error saving discovered device to database: no running event loop
/home/coastal/smartvenue/backend/app/main.py:200: RuntimeWarning: coroutine 'on_device_discovered.<locals>.fetch_caps' was never awaited
  db.rollback()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
INFO:     100.98.57.42:63046 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:50364 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:61355 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:51172 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
2025-10-07 18:03:29,056 - app.services.device_status_checker - INFO - Checking status of 4 devices
INFO:     100.98.57.42:51275 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:57049 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:58761 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
2025-10-07 18:04:06,615 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 18:04:06,616 - app.services.device_health - INFO - Checking health of 1 managed devices
INFO:     100.98.57.42:61151 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
2025-10-07 18:04:09,354 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 18:04:09,559 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dca09e
2025-10-07 18:04:09,563 - app.services.device_health - INFO - Health check complete: 1/1 devices online
INFO:     100.98.57.42:49693 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:59011 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:61009 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:53223 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:53223 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:53223 - "GET /api/v1/settings/app?include_private=true HTTP/1.1" 200 OK
INFO:     100.98.57.42:64238 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:59607 - "OPTIONS /api/v1/management/manage/ir-dc4516 HTTP/1.1" 200 OK
INFO:     100.98.57.42:60138 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
2025-10-07 18:05:09,464 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dc4516
2025-10-07 18:05:09,650 - app.services.esphome_client - INFO - Disconnected from ESPHome device: ir-dc4516
INFO:     100.98.57.42:59607 - "POST /api/v1/management/manage/ir-dc4516 HTTP/1.1" 200 OK
INFO:     100.98.57.42:59607 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:60138 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:60138 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:62908 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:50888 - "GET /api/v1/management/available-channels HTTP/1.1" 200 OK
INFO:     100.98.57.42:60138 - "GET /api/v1/ir-codes/libraries/1799/commands HTTP/1.1" 200 OK
INFO:     100.98.57.42:62675 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:50361 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:51143 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:62675 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:58447 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:52260 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:59356 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:65492 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:65492 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:65492 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:53287 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:64208 - "GET /api/v1/management/available-channels HTTP/1.1" 200 OK
INFO:     100.98.57.42:61628 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:64208 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:61628 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:65492 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:53287 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:51959 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:57427 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:57427 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:57427 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:57427 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:57427 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:57427 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:57427 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:57427 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:57427 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:55462 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:60517 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:54183 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:56145 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:57460 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:57472 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:57460 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:57472 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:57478 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:57478 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:57478 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:57478 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:45470 - "OPTIONS /api/virtual-controllers/nw-b85a97 HTTP/1.1" 200 OK
INFO:     127.0.0.1:45470 - "DELETE /api/virtual-controllers/nw-b85a97 HTTP/1.1" 200 OK
INFO:     127.0.0.1:45470 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:45470 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:45458 - "OPTIONS /api/network-tv/command HTTP/1.1" 200 OK
2025-10-07 18:06:42,568 - root - INFO - Sending handshake.
2025-10-07 18:06:42,674 - root - INFO - Sending control command: KEY_VOLUP
INFO:     127.0.0.1:45482 - "POST /api/network-tv/command HTTP/1.1" 200 OK
2025-10-07 18:06:44,267 - root - INFO - Sending handshake.
2025-10-07 18:06:44,282 - root - INFO - Sending control command: KEY_VOLUP
INFO:     127.0.0.1:45482 - "POST /api/network-tv/command HTTP/1.1" 200 OK
INFO:     127.0.0.1:34276 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     127.0.0.1:34290 - "POST /api/network-tv/adopt/192.168.101.50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:34290 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:34290 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
2025-10-07 18:08:31,104 - app.services.device_status_checker - INFO - Checking status of 4 devices
INFO:     127.0.0.1:36618 - "DELETE /api/virtual-controllers/nw-b85a97 HTTP/1.1" 200 OK
INFO:     127.0.0.1:36618 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:36618 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
2025-10-07 18:09:09,563 - app.services.device_health - INFO - Starting scheduled device health check
2025-10-07 18:09:09,563 - app.services.device_health - INFO - Checking health of 2 managed devices
WARNING:  WatchFiles detected changes in 'app/routers/network_tv.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 18:09:10,712 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 18:09:10,712 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 18:09:10,712 - app.main - INFO - TV status polling service stopped
2025-10-07 18:09:10,712 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 18:09:10,712 - app.main - INFO - Device status monitoring stopped
2025-10-07 18:09:10,712 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 18:09:10,712 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 18:09:10,712 - app.main - INFO - Schedule processor stopped
2025-10-07 18:09:10,713 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 18:09:10,713 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 18:09:10,713 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 18:09:10,713 - app.main - INFO - History cleanup service stopped
2025-10-07 18:09:10,713 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 18:09:10,713 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 18:09:10,713 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 18:09:10,713 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 18:09:10,713 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 18:09:10,713 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 18:09:10,713 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 18:09:10,713 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 18:09:10,713 - app.main - INFO - Command queue processor stopped
2025-10-07 18:09:10,713 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 18:09:10,713 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error while finishing connection: Finishing connection cancelled
2025-10-07 18:09:10,713 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dca09e
2025-10-07 18:09:10,713 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error while finishing connection: Finishing connection cancelled
2025-10-07 18:09:10,714 - app.services.device_health - INFO - Scanning 21 IPs for device ir-dc4516
2025-10-07 18:09:10,714 - aioesphomeapi.connection - WARNING - 192.168.101.132: Connection error occurred: 192.168.101.132: Connection lost
2025-10-07 18:09:10,714 - aioesphomeapi.connection - WARNING - 192.168.101.146: Connection error occurred: 192.168.101.146: Connection lost
2025-10-07 18:09:10,811 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.122', 6053): [Errno 111] Connect call failed ('192.168.101.122', 6053)
2025-10-07 18:09:13,762 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.136', 6053): [Errno 113] Connect call failed ('192.168.101.136', 6053)
2025-10-07 18:09:13,890 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.123', 6053): [Errno 113] Connect call failed ('192.168.101.123', 6053)
2025-10-07 18:09:16,834 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.137', 6053): [Errno 113] Connect call failed ('192.168.101.137', 6053)
2025-10-07 18:09:16,962 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.124', 6053): [Errno 113] Connect call failed ('192.168.101.124', 6053)
2025-10-07 18:09:19,906 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.138', 6053): [Errno 113] Connect call failed ('192.168.101.138', 6053)
2025-10-07 18:09:22,978 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.139', 6053): [Errno 113] Connect call failed ('192.168.101.139', 6053)
2025-10-07 18:09:26,050 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.140', 6053): [Errno 113] Connect call failed ('192.168.101.140', 6053)
2025-10-07 18:09:26,963 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error while starting connection: Starting connection cancelled
2025-10-07 18:09:29,122 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.141', 6053): [Errno 113] Connect call failed ('192.168.101.141', 6053)
2025-10-07 18:09:29,223 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.142', 6053): [Errno 111] Connect call failed ('192.168.101.142', 6053)
2025-10-07 18:09:30,018 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.126', 6053): [Errno 113] Connect call failed ('192.168.101.126', 6053)
2025-10-07 18:09:32,322 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.143', 6053): [Errno 113] Connect call failed ('192.168.101.143', 6053)
2025-10-07 18:09:33,090 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.127', 6053): [Errno 113] Connect call failed ('192.168.101.127', 6053)
2025-10-07 18:09:33,092 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.128', 6053): [Errno 111] Connect call failed ('192.168.101.128', 6053)
2025-10-07 18:09:35,394 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.144', 6053): [Errno 113] Connect call failed ('192.168.101.144', 6053)
2025-10-07 18:09:36,162 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.129', 6053): [Errno 113] Connect call failed ('192.168.101.129', 6053)
2025-10-07 18:09:38,466 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.145', 6053): [Errno 113] Connect call failed ('192.168.101.145', 6053)
2025-10-07 18:09:46,164 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error while starting connection: Starting connection cancelled
2025-10-07 18:09:48,467 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error while starting connection: Starting connection cancelled
2025-10-07 18:09:49,218 - app.services.esphome_client - ERROR - Failed to connect to ir-dca09e: Error connecting to ('192.168.101.131', 6053): [Errno 113] Connect call failed ('192.168.101.131', 6053)
2025-10-07 18:09:51,522 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.147', 6053): [Errno 113] Connect call failed ('192.168.101.147', 6053)
2025-10-07 18:09:52,006 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dca09e
2025-10-07 18:09:52,050 - app.services.device_health - INFO - Found device ir-dca09e at new IP: 192.168.101.132
2025-10-07 18:09:54,594 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.148', 6053): [Errno 113] Connect call failed ('192.168.101.148', 6053)
2025-10-07 18:09:57,666 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.149', 6053): [Errno 113] Connect call failed ('192.168.101.149', 6053)
2025-10-07 18:10:00,738 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.150', 6053): [Errno 113] Connect call failed ('192.168.101.150', 6053)
2025-10-07 18:10:03,810 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.151', 6053): [Errno 113] Connect call failed ('192.168.101.151', 6053)
2025-10-07 18:10:06,882 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.152', 6053): [Errno 113] Connect call failed ('192.168.101.152', 6053)
2025-10-07 18:10:06,883 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.153', 6053): [Errno 111] Connect call failed ('192.168.101.153', 6053)
2025-10-07 18:10:09,954 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.154', 6053): [Errno 113] Connect call failed ('192.168.101.154', 6053)
2025-10-07 18:10:19,960 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error while starting connection: Starting connection cancelled
2025-10-07 18:10:23,010 - app.services.esphome_client - ERROR - Failed to connect to ir-dc4516: Error connecting to ('192.168.101.156', 6053): [Errno 113] Connect call failed ('192.168.101.156', 6053)
2025-10-07 18:10:23,011 - app.main - INFO - Device health monitoring stopped
2025-10-07 18:10:23,011 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 18:10:23,011 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 18:10:23,011 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [594984]
WARNING:  WatchFiles detected changes in 'app/routers/network_tv.py'. Reloading...
/home/coastal/smartvenue/backend/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [595899]
INFO:     Waiting for application startup.
2025-10-07 18:10:25,005 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 18:10:25,011 - app.main - INFO - Database tables created
2025-10-07 18:10:25,032 - app.main - INFO - Database initialized with seed data
2025-10-07 18:10:25,032 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 18:10:25,033 - app.services.discovery - INFO - Device discovery started
2025-10-07 18:10:25,033 - app.main - INFO - Device discovery started
2025-10-07 18:10:25,033 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 18:10:25,033 - app.main - INFO - Device health monitoring started
2025-10-07 18:10:25,033 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 18:10:25,033 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 18:10:25,033 - app.main - INFO - Command queue processor started
2025-10-07 18:10:25,033 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 18:10:25,033 - app.main - INFO - History cleanup service started
2025-10-07 18:10:25,033 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 18:10:25,034 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 18:10:25,036 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 18:10:25,036 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 18:10:25,036 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 18:10:25,036 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 18:10:25,037 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 18:10:25,037 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 18:10:25,037 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 18:10:25,037 - app.main - INFO - Schedule processor started
2025-10-07 18:10:25,037 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 18:10:25,037 - app.main - INFO - Device status monitoring started
2025-10-07 18:10:25,037 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 18:10:25,037 - app.main - INFO - TV status polling service started
2025-10-07 18:10:25,037 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 18:10:25,041 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 18:10:25,042 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 18:10:25,043 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 8.8 hours)
2025-10-07 18:10:25,048 - app.services.device_status_checker - INFO - Checking status of 3 devices
INFO:     Application startup complete.
2025-10-07 18:10:27,107 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
Template seeding complete; using dynamic IR library system.
INFO:     127.0.0.1:34268 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:57546 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:53680 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
2025-10-07 18:10:27,143 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 18:10:27,143 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 18:10:27,143 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
INFO:     127.0.0.1:34258 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
2025-10-07 18:10:27,146 - app.main - ERROR - Error saving discovered device to database: no running event loop
/home/coastal/smartvenue/backend/app/main.py:200: RuntimeWarning: coroutine 'on_device_discovered.<locals>.fetch_caps' was never awaited
  db.rollback()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
INFO:     127.0.0.1:34274 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     100.98.57.42:52669 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
2025-10-07 18:10:27,156 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
INFO:     100.98.57.42:53065 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
2025-10-07 18:10:27,157 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 18:10:27,157 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 18:10:27,157 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 18:10:27,160 - app.main - INFO - Saved kitchen-fan to DeviceDiscovery table
INFO:     100.98.57.42:52669 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:53065 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:63687 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:52533 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:55645 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
2025-10-07 18:10:27,224 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 18:10:27,224 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 18:10:27,224 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 18:10:27,224 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 18:10:27,228 - app.main - INFO - Saved bt-proxy-office to DeviceDiscovery table
2025-10-07 18:10:27,251 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 18:10:27,252 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 18:10:27,252 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 18:10:27,252 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 18:10:27,258 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 18:10:27,262 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 18:10:27,263 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 18:10:27,263 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 18:10:27,263 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 18:10:27,269 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 18:10:27,481 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 18:10:27,481 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 18:10:27,481 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 18:10:27,481 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 18:10:27,484 - app.main - INFO - Saved esp32-bluetooth-proxy-f32ccc to DeviceDiscovery table
2025-10-07 18:10:28,257 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 18:10:28,257 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 18:10:28,257 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:10:28,257 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:10:28,261 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 18:10:28,275 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 18:10:28,276 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 18:10:28,276 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 18:10:28,276 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 18:10:28,276 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 18:10:28,294 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 18:10:28,294 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 18:10:28,294 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 18:10:28,294 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 18:10:28,297 - app.main - INFO - Saved waterheater to DeviceDiscovery table
2025-10-07 18:10:28,383 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 18:10:28,383 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 18:10:28,383 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 18:10:28,383 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 18:10:28,386 - app.main - INFO - Saved loungefan to DeviceDiscovery table
2025-10-07 18:10:28,426 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 18:10:28,427 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 18:10:28,427 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 18:10:28,427 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 18:10:28,429 - app.main - INFO - Saved presence-garage to DeviceDiscovery table
2025-10-07 18:10:28,575 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 18:10:28,575 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 18:10:28,575 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 18:10:28,575 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 18:10:28,581 - app.main - INFO - Saved bt-proxy-garage to DeviceDiscovery table
INFO:     127.0.0.1:60166 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:60154 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:60154 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:60166 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:60166 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     127.0.0.1:33854 - "OPTIONS /api/network-tv/adopt/192.168.101.50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:33854 - "POST /api/network-tv/adopt/192.168.101.50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:33854 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:33854 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     100.98.57.42:55605 - "GET /api/v1/management/discovered HTTP/1.1" 200 OK
INFO:     100.98.57.42:55605 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:55605 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:53311 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:55925 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:53483 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:51647 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:61318 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:53483 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:56510 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:56767 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:56510 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:56767 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:63526 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:58051 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:59628 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:61057 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:62091 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:55691 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:62091 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:55691 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:49952 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:61816 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
WARNING:  WatchFiles detected changes in 'app/routers/network_tv.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 18:13:15,970 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 18:13:15,970 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 18:13:15,970 - app.main - INFO - TV status polling service stopped
2025-10-07 18:13:15,970 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 18:13:15,970 - app.main - INFO - Device status monitoring stopped
2025-10-07 18:13:15,970 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 18:13:15,970 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 18:13:15,970 - app.main - INFO - Schedule processor stopped
2025-10-07 18:13:15,970 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 18:13:15,970 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 18:13:15,970 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 18:13:15,970 - app.main - INFO - History cleanup service stopped
2025-10-07 18:13:15,970 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 18:13:15,970 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 18:13:15,970 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 18:13:15,970 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 18:13:15,970 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 18:13:15,970 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 18:13:15,970 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 18:13:15,971 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 18:13:15,971 - app.main - INFO - Command queue processor stopped
2025-10-07 18:13:15,971 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 18:13:15,971 - app.main - INFO - Device health monitoring stopped
2025-10-07 18:13:15,971 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 18:13:15,971 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 18:13:15,971 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [595899]
/home/coastal/smartvenue/backend/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [596037]
INFO:     Waiting for application startup.
2025-10-07 18:13:17,645 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 18:13:17,650 - app.main - INFO - Database tables created
2025-10-07 18:13:17,671 - app.main - INFO - Database initialized with seed data
2025-10-07 18:13:17,671 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 18:13:17,673 - app.services.discovery - INFO - Device discovery started
2025-10-07 18:13:17,673 - app.main - INFO - Device discovery started
2025-10-07 18:13:17,673 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 18:13:17,673 - app.main - INFO - Device health monitoring started
2025-10-07 18:13:17,673 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 18:13:17,673 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 18:13:17,673 - app.main - INFO - Command queue processor started
2025-10-07 18:13:17,673 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 18:13:17,673 - app.main - INFO - History cleanup service started
2025-10-07 18:13:17,673 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 18:13:17,674 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 18:13:17,675 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 18:13:17,676 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 18:13:17,676 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 18:13:17,676 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 18:13:17,676 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 18:13:17,676 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 18:13:17,676 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 18:13:17,676 - app.main - INFO - Schedule processor started
2025-10-07 18:13:17,676 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 18:13:17,676 - app.main - INFO - Device status monitoring started
2025-10-07 18:13:17,676 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 18:13:17,676 - app.main - INFO - TV status polling service started
2025-10-07 18:13:17,677 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 18:13:17,681 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 18:13:17,682 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 18:13:17,682 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 8.8 hours)
2025-10-07 18:13:17,687 - app.services.device_status_checker - INFO - Checking status of 4 devices
INFO:     Application startup complete.
2025-10-07 18:13:19,745 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 18:13:19,746 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 18:13:19,746 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 18:13:19,746 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 18:13:19,752 - app.main - ERROR - Error saving discovered device to database: no running event loop
/home/coastal/smartvenue/backend/app/main.py:200: RuntimeWarning: coroutine 'on_device_discovered.<locals>.fetch_caps' was never awaited
  db.rollback()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-10-07 18:13:19,761 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 18:13:19,761 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 18:13:19,761 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 18:13:19,761 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 18:13:19,764 - app.main - INFO - Saved kitchen-fan to DeviceDiscovery table
2025-10-07 18:13:19,782 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 18:13:19,782 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 18:13:19,783 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 18:13:19,783 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 18:13:19,785 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
2025-10-07 18:13:19,796 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 18:13:19,796 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 18:13:19,796 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 18:13:19,796 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 18:13:19,799 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 18:13:19,801 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 18:13:19,801 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 18:13:19,801 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 18:13:19,801 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 18:13:19,812 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 18:13:19,955 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 18:13:19,956 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 18:13:19,956 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 18:13:19,956 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 18:13:19,959 - app.main - INFO - Saved bt-proxy-office to DeviceDiscovery table
2025-10-07 18:13:19,978 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 18:13:19,978 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 18:13:19,978 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 18:13:19,978 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 18:13:19,981 - app.main - INFO - Saved esp32-bluetooth-proxy-f32ccc to DeviceDiscovery table
2025-10-07 18:13:19,984 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 18:13:19,984 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 18:13:19,984 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 18:13:19,984 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 18:13:19,987 - app.main - INFO - Saved waterheater to DeviceDiscovery table
2025-10-07 18:13:20,084 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 18:13:20,085 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 18:13:20,085 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 18:13:20,085 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 18:13:20,088 - app.main - INFO - Saved bt-proxy-garage to DeviceDiscovery table
2025-10-07 18:13:20,876 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 18:13:20,877 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 18:13:20,877 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:13:20,877 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:13:20,880 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 18:13:20,903 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 18:13:20,903 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 18:13:20,903 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 18:13:20,903 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 18:13:20,906 - app.main - INFO - Saved presence-garage to DeviceDiscovery table
2025-10-07 18:13:20,907 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 18:13:20,907 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 18:13:20,907 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 18:13:20,907 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 18:13:20,910 - app.main - INFO - Saved loungefan to DeviceDiscovery table
WARNING:  WatchFiles detected changes in 'app/routers/network_tv.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-10-07 18:13:21,946 - app.main - INFO - Shutting down SmartVenue backend...
2025-10-07 18:13:21,946 - app.services.tv_status_poller - INFO - ‚èπÔ∏è  Stopping TV status polling service
2025-10-07 18:13:21,946 - app.main - INFO - TV status polling service stopped
2025-10-07 18:13:21,946 - app.services.device_status_checker - INFO - Device status monitoring stopped
2025-10-07 18:13:21,946 - app.main - INFO - Device status monitoring stopped
2025-10-07 18:13:21,946 - app.services.schedule_processor - INFO - Stopping schedule processor...
2025-10-07 18:13:21,946 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor stopped
2025-10-07 18:13:21,946 - app.main - INFO - Schedule processor stopped
2025-10-07 18:13:21,946 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-10-07 18:13:21,946 - app.services.history_cleanup - INFO - History cleanup loop cancelled
2025-10-07 18:13:21,946 - app.services.history_cleanup - INFO - History cleanup service stopped
2025-10-07 18:13:21,946 - app.main - INFO - History cleanup service stopped
2025-10-07 18:13:21,946 - app.services.queue_processor - INFO - Stopping queue processor...
2025-10-07 18:13:21,946 - app.services.queue_processor - INFO - Worker 0 cancelled
2025-10-07 18:13:21,946 - app.services.queue_processor - INFO - Worker 0 stopped
2025-10-07 18:13:21,946 - app.services.queue_processor - INFO - Worker 1 cancelled
2025-10-07 18:13:21,946 - app.services.queue_processor - INFO - Worker 1 stopped
2025-10-07 18:13:21,946 - app.services.queue_processor - INFO - Worker 2 cancelled
2025-10-07 18:13:21,946 - app.services.queue_processor - INFO - Worker 2 stopped
2025-10-07 18:13:21,946 - app.services.queue_processor - INFO - ‚úì Queue processor stopped
2025-10-07 18:13:21,946 - app.main - INFO - Command queue processor stopped
2025-10-07 18:13:21,946 - app.services.device_health - INFO - Stopping device health monitoring service
2025-10-07 18:13:21,946 - app.main - INFO - Device health monitoring stopped
2025-10-07 18:13:21,946 - app.services.discovery - INFO - Stopping device discovery...
2025-10-07 18:13:21,947 - app.services.discovery - INFO - Device discovery stopped
2025-10-07 18:13:21,947 - app.main - INFO - Device discovery stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [596037]
Template seeding complete; using dynamic IR library system.
/home/coastal/smartvenue/backend/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_info" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [596060]
INFO:     Waiting for application startup.
2025-10-07 18:13:23,576 - app.main - INFO - Starting SmartVenue backend...
2025-10-07 18:13:23,581 - app.main - INFO - Database tables created
2025-10-07 18:13:23,604 - app.main - INFO - Database initialized with seed data
2025-10-07 18:13:23,604 - app.services.discovery - INFO - Starting ESPHome device discovery...
2025-10-07 18:13:23,605 - app.services.discovery - INFO - Device discovery started
2025-10-07 18:13:23,605 - app.main - INFO - Device discovery started
2025-10-07 18:13:23,605 - app.services.device_health - INFO - Starting device health monitoring service
2025-10-07 18:13:23,605 - app.main - INFO - Device health monitoring started
2025-10-07 18:13:23,605 - app.services.queue_processor - INFO - Starting queue processor with 3 workers...
2025-10-07 18:13:23,605 - app.services.queue_processor - INFO - ‚úì Queue processor started with 3 workers
2025-10-07 18:13:23,606 - app.main - INFO - Command queue processor started
2025-10-07 18:13:23,606 - app.services.history_cleanup - INFO - History cleanup service started (retention: 7 days, cleanup time: 03:00:00)
2025-10-07 18:13:23,606 - app.main - INFO - History cleanup service started
2025-10-07 18:13:23,606 - app.services.schedule_processor - INFO - Starting schedule processor...
2025-10-07 18:13:23,607 - tzlocal - WARNING - /etc/timezone is deprecated in some distros, and no longer reliable. tzlocal is ignoring it, and you can likely delete it.
2025-10-07 18:13:23,609 - app.services.schedule_processor - INFO - Loading 1 active schedules...
2025-10-07 18:13:23,609 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-07 18:13:23,609 - app.services.schedule_processor - INFO -   ‚úì Loaded schedule: Test Update2 (ID: 1)
2025-10-07 18:13:23,609 - app.services.schedule_processor - INFO - ‚úÖ Loaded 1 schedules
2025-10-07 18:13:23,610 - apscheduler.scheduler - INFO - Added job "Test Update2" to job store "default"
2025-10-07 18:13:23,610 - apscheduler.scheduler - INFO - Scheduler started
2025-10-07 18:13:23,610 - app.services.schedule_processor - INFO - ‚úÖ Schedule processor started successfully
2025-10-07 18:13:23,610 - app.main - INFO - Schedule processor started
2025-10-07 18:13:23,610 - app.services.device_status_checker - INFO - Device status monitoring started
2025-10-07 18:13:23,610 - app.main - INFO - Device status monitoring started
2025-10-07 18:13:23,610 - app.services.tv_status_poller - INFO - üîÑ Starting TV status polling service
2025-10-07 18:13:23,610 - app.main - INFO - TV status polling service started
2025-10-07 18:13:23,610 - app.services.queue_processor - INFO - Worker 0 started
2025-10-07 18:13:23,615 - app.services.queue_processor - INFO - Worker 1 started
2025-10-07 18:13:23,615 - app.services.queue_processor - INFO - Worker 2 started
2025-10-07 18:13:23,616 - app.services.history_cleanup - INFO - Next history cleanup scheduled for 2025-10-08 03:00:00 (in 8.8 hours)
2025-10-07 18:13:23,621 - app.services.device_status_checker - INFO - Checking status of 4 devices
INFO:     Application startup complete.
2025-10-07 18:13:25,785 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 18:13:25,785 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 18:13:25,785 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:13:25,785 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:13:25,794 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
2025-10-07 18:13:25,898 - app.services.discovery - INFO - mDNS service discovered: presence-garage._esphomelib._tcp.local.
2025-10-07 18:13:25,898 - app.services.discovery - INFO - Processing mDNS device: presence-garage at 192.168.101.21:6053
2025-10-07 18:13:25,898 - app.services.discovery - INFO - Discovered ESPHome device: presence-garage (192.168.101.21)
2025-10-07 18:13:25,898 - app.main - INFO - New device discovered: presence-garage (192.168.101.21)
2025-10-07 18:13:25,901 - app.main - INFO - Saved presence-garage to DeviceDiscovery table
2025-10-07 18:13:25,921 - app.services.discovery - INFO - mDNS service discovered: loungefan._esphomelib._tcp.local.
2025-10-07 18:13:25,922 - app.services.discovery - INFO - Processing mDNS device: loungefan at 192.168.101.39:6053
2025-10-07 18:13:25,922 - app.services.discovery - INFO - Discovered ESPHome device: loungefan (192.168.101.39)
2025-10-07 18:13:25,922 - app.main - INFO - New device discovered: loungefan (192.168.101.39)
2025-10-07 18:13:25,925 - app.main - INFO - Saved loungefan to DeviceDiscovery table
2025-10-07 18:13:25,929 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-right._esphomelib._tcp.local.
2025-10-07 18:13:25,929 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-right at 192.168.101.96:6053
2025-10-07 18:13:25,929 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-right (192.168.101.96)
2025-10-07 18:13:25,929 - app.main - INFO - New device discovered: light-kitchen-right (192.168.101.96)
2025-10-07 18:13:25,932 - app.main - INFO - Saved light-kitchen-right to DeviceDiscovery table
2025-10-07 18:13:25,945 - app.services.discovery - INFO - mDNS service discovered: light-kitchen-left._esphomelib._tcp.local.
2025-10-07 18:13:25,945 - app.services.discovery - INFO - Processing mDNS device: light-kitchen-left at 192.168.101.114:6053
2025-10-07 18:13:25,945 - app.services.discovery - INFO - Discovered ESPHome device: light-kitchen-left (192.168.101.114)
2025-10-07 18:13:25,945 - app.main - INFO - New device discovered: light-kitchen-left (192.168.101.114)
2025-10-07 18:13:25,948 - app.main - INFO - Saved light-kitchen-left to DeviceDiscovery table
2025-10-07 18:13:26,716 - app.services.discovery - INFO - mDNS service discovered: ir-dca09e._esphomelib._tcp.local.
2025-10-07 18:13:26,717 - app.services.discovery - INFO - Processing mDNS device: ir-dca09e at 192.168.101.132:6053
2025-10-07 18:13:26,717 - app.services.discovery - INFO - Discovered ESPHome device: ir-dca09e (192.168.101.132)
2025-10-07 18:13:26,717 - app.main - INFO - New device discovered: ir-dca09e (192.168.101.132)
2025-10-07 18:13:26,717 - app.main - ERROR - Error saving discovered device to database: no running event loop
/home/coastal/smartvenue/backend/app/main.py:200: RuntimeWarning: coroutine 'on_device_discovered.<locals>.fetch_caps' was never awaited
  db.rollback()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-10-07 18:13:26,742 - app.services.discovery - INFO - mDNS service discovered: kitchen-fan._esphomelib._tcp.local.
2025-10-07 18:13:26,742 - app.services.discovery - INFO - Processing mDNS device: kitchen-fan at 192.168.101.29:6053
2025-10-07 18:13:26,742 - app.services.discovery - INFO - Discovered ESPHome device: kitchen-fan (192.168.101.29)
2025-10-07 18:13:26,742 - app.main - INFO - New device discovered: kitchen-fan (192.168.101.29)
2025-10-07 18:13:26,745 - app.main - INFO - Saved kitchen-fan to DeviceDiscovery table
2025-10-07 18:13:26,925 - app.services.discovery - INFO - mDNS service discovered: esp32-bluetooth-proxy-f32ccc._esphomelib._tcp.local.
2025-10-07 18:13:26,926 - app.services.discovery - INFO - Processing mDNS device: esp32-bluetooth-proxy-f32ccc at 192.168.101.37:6053
2025-10-07 18:13:26,926 - app.services.discovery - INFO - Discovered ESPHome device: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 18:13:26,926 - app.main - INFO - New device discovered: esp32-bluetooth-proxy-f32ccc (192.168.101.37)
2025-10-07 18:13:26,930 - app.main - INFO - Saved esp32-bluetooth-proxy-f32ccc to DeviceDiscovery table
2025-10-07 18:13:27,026 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-office._esphomelib._tcp.local.
2025-10-07 18:13:27,026 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-office at 192.168.101.34:6053
2025-10-07 18:13:27,026 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-office (192.168.101.34)
2025-10-07 18:13:27,026 - app.main - INFO - New device discovered: bt-proxy-office (192.168.101.34)
2025-10-07 18:13:27,029 - app.main - INFO - Saved bt-proxy-office to DeviceDiscovery table
Template seeding complete; using dynamic IR library system.
INFO:     127.0.0.1:42598 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:42608 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:42598 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:42608 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
2025-10-07 18:13:30,978 - app.services.discovery - INFO - mDNS service discovered: waterheater._esphomelib._tcp.local.
2025-10-07 18:13:30,978 - app.services.discovery - INFO - Processing mDNS device: waterheater at 192.168.101.73:6053
2025-10-07 18:13:30,978 - app.services.discovery - INFO - Discovered ESPHome device: waterheater (192.168.101.73)
2025-10-07 18:13:30,978 - app.main - INFO - New device discovered: waterheater (192.168.101.73)
2025-10-07 18:13:30,984 - app.main - INFO - Saved waterheater to DeviceDiscovery table
2025-10-07 18:13:31,048 - app.services.discovery - INFO - mDNS service discovered: bt-proxy-garage._esphomelib._tcp.local.
2025-10-07 18:13:31,048 - app.services.discovery - INFO - Processing mDNS device: bt-proxy-garage at 192.168.101.38:6053
2025-10-07 18:13:31,048 - app.services.discovery - INFO - Discovered ESPHome device: bt-proxy-garage (192.168.101.38)
2025-10-07 18:13:31,048 - app.main - INFO - New device discovered: bt-proxy-garage (192.168.101.38)
2025-10-07 18:13:31,051 - app.main - INFO - Saved bt-proxy-garage to DeviceDiscovery table
2025-10-07 18:13:34,301 - app.services.discovery - INFO - mDNS service discovered: ir-dc4516._esphomelib._tcp.local.
2025-10-07 18:13:34,302 - app.services.discovery - INFO - Processing mDNS device: ir-dc4516 at 192.168.101.146:6053
2025-10-07 18:13:34,302 - app.services.discovery - INFO - Discovered ESPHome device: ir-dc4516 (192.168.101.146)
2025-10-07 18:13:34,302 - app.main - INFO - New device discovered: ir-dc4516 (192.168.101.146)
2025-10-07 18:13:34,302 - app.main - ERROR - Error saving discovered device to database: no running event loop
2025-10-07 18:13:39,992 - app.services.discovery - INFO - mDNS service discovered: mainpowermonitor._esphomelib._tcp.local.
2025-10-07 18:13:39,993 - app.services.discovery - INFO - Processing mDNS device: mainpowermonitor at 192.168.101.43:6053
2025-10-07 18:13:39,993 - app.services.discovery - INFO - Discovered ESPHome device: mainpowermonitor (192.168.101.43)
2025-10-07 18:13:39,993 - app.main - INFO - New device discovered: mainpowermonitor (192.168.101.43)
2025-10-07 18:13:39,999 - app.main - INFO - Saved mainpowermonitor to DeviceDiscovery table
INFO:     127.0.0.1:42624 - "DELETE /api/virtual-controllers/nw-b85a97 HTTP/1.1" 200 OK
INFO:     127.0.0.1:42624 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:42624 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:42624 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     127.0.0.1:57324 - "POST /api/network-tv/adopt/192.168.101.50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:57324 - "GET /api/network-tv/discover HTTP/1.1" 200 OK
INFO:     127.0.0.1:57324 - "GET /api/virtual-controllers/ HTTP/1.1" 200 OK
INFO:     100.98.57.42:64444 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:60236 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:64678 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:64986 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:62359 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:53220 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:60236 - "GET /api/v1/management/managed HTTP/1.1" 200 OK
INFO:     100.98.57.42:64444 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:60620 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:60826 - "GET /api/v1/settings/tags HTTP/1.1" 200 OK
INFO:     100.98.57.42:56417 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:62489 - "GET /api/v1/management/available-channels HTTP/1.1" 200 OK
INFO:     100.98.57.42:50918 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:60485 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:60620 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:62489 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:62489 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:62489 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:62489 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:62489 - "OPTIONS /api/v1/commands/bulk HTTP/1.1" 200 OK
INFO:     100.98.57.42:62489 - "POST /api/v1/commands/bulk HTTP/1.1" 200 OK
INFO:     100.98.57.42:62489 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:62489 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:55748 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:49639 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:62489 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:49630 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:62489 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:62489 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "POST /api/v1/commands/bulk HTTP/1.1" 200 OK
2025-10-07 18:15:00,805 - app.services.queue_processor - INFO - Worker 0 executing command 10: volume_down on ir-dc4516 port 1 (attempt 1)
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
2025-10-07 18:15:03,823 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dc4516
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:55868 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:55868 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:55868 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:55868 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
2025-10-07 18:15:03,957 - app.services.esphome_client - INFO - Called service 'tv_volume_down' on ir-dc4516 with data: {'port': 1}
2025-10-07 18:15:03,961 - app.services.queue_processor - INFO - ‚úì Worker 0 completed command 10 in 3150ms
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "POST /api/v1/commands/bulk HTTP/1.1" 200 OK
2025-10-07 18:15:08,822 - app.services.queue_processor - INFO - Worker 1 executing command 11: volume_down on ir-dc4516 port 1 (attempt 1)
2025-10-07 18:15:09,016 - app.services.esphome_client - INFO - Called service 'tv_volume_down' on ir-dc4516 with data: {'port': 1}
2025-10-07 18:15:09,019 - app.services.queue_processor - INFO - ‚úì Worker 1 completed command 11 in 193ms
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "POST /api/v1/commands/bulk HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "POST /api/v1/commands/bulk HTTP/1.1" 200 OK
2025-10-07 18:15:19,841 - app.services.queue_processor - INFO - Worker 2 executing command 13: volume_down on ir-dc4516 port 1 (attempt 1)
2025-10-07 18:15:19,998 - app.services.esphome_client - INFO - Called service 'tv_volume_down' on ir-dc4516 with data: {'port': 1}
2025-10-07 18:15:20,002 - app.services.queue_processor - INFO - ‚úì Worker 2 completed command 13 in 157ms
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "POST /api/v1/commands/bulk HTTP/1.1" 200 OK
2025-10-07 18:15:30,522 - app.services.queue_processor - INFO - Worker 2 executing command 14: power_off on ir-dc4516 port 1 (attempt 1)
2025-10-07 18:15:30,666 - app.services.esphome_client - INFO - Called service 'tv_power_off' on ir-dc4516 with data: {'port': 1}
2025-10-07 18:15:30,672 - app.services.queue_processor - INFO - ‚úì Worker 2 completed command 14 in 144ms
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "POST /api/v1/commands/bulk HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
2025-10-07 18:16:03,826 - aioesphomeapi.connection - WARNING - ir-dc4516 @ 192.168.101.146: Connection error occurred: [Errno 104] Connection reset by peer
INFO:     100.98.57.42:61603 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:63549 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:63549 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:63549 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "POST /api/v1/commands/bulk HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "POST /api/v1/commands/bulk HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "POST /api/v1/commands/bulk HTTP/1.1" 200 OK
2025-10-07 18:16:49,096 - app.services.queue_processor - INFO - Worker 0 executing command 16: volume_down on ir-dc4516 port 1 (attempt 1)
2025-10-07 18:16:49,097 - app.services.esphome_client - ERROR - Error calling service 'tv_volume_down' on ir-dc4516: Not connected to ir-dc4516 @ 192.168.101.146!
2025-10-07 18:16:49,100 - app.services.queue_processor - WARNING - ‚úó Worker 0 failed command 16: Command execution failed (attempt 1)
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
2025-10-07 18:16:51,106 - app.services.queue_processor - INFO - Worker 0 executing command 16: volume_down on ir-dc4516 port 1 (attempt 2)
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
2025-10-07 18:16:53,815 - app.services.esphome_client - INFO - Connected to ESPHome device: ir-dc4516
2025-10-07 18:16:53,953 - app.services.esphome_client - INFO - Called service 'tv_volume_down' on ir-dc4516 with data: {'port': 1}
2025-10-07 18:16:53,957 - app.services.queue_processor - INFO - ‚úì Worker 0 completed command 16 in 2846ms
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "POST /api/v1/commands/bulk HTTP/1.1" 200 OK
2025-10-07 18:16:56,464 - app.services.queue_processor - INFO - Worker 0 executing command 17: volume_down on ir-dc4516 port 1 (attempt 1)
2025-10-07 18:16:56,607 - app.services.esphome_client - INFO - Called service 'tv_volume_down' on ir-dc4516 with data: {'port': 1}
2025-10-07 18:16:56,611 - app.services.queue_processor - INFO - ‚úì Worker 0 completed command 17 in 142ms
INFO:     100.98.57.42:63329 - "POST /api/v1/commands/bulk HTTP/1.1" 200 OK
2025-10-07 18:16:56,644 - app.services.queue_processor - INFO - Worker 1 executing command 18: volume_down on ir-dc4516 port 1 (attempt 1)
2025-10-07 18:16:56,820 - app.services.esphome_client - INFO - Called service 'tv_volume_down' on ir-dc4516 with data: {'port': 1}
2025-10-07 18:16:56,824 - app.services.queue_processor - INFO - ‚úì Worker 1 completed command 18 in 175ms
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/ir-dca09e/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/ir-dc4516/port-status HTTP/1.1" 200 OK
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/nw-9cf332/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/nw-b85a97/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:63329 - "GET /api/v1/commands/nw-bb2229/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/nw-f5a756/port-status HTTP/1.1" 404 Not Found
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
2025-10-07 18:17:42,971 - app.services.discovery - INFO - mDNS service discovered: rearpowerboardmonitor._esphomelib._tcp.local.
2025-10-07 18:17:42,971 - app.services.discovery - INFO - Processing mDNS device: rearpowerboardmonitor at 192.168.101.27:6053
2025-10-07 18:17:42,971 - app.services.discovery - INFO - Discovered ESPHome device: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:17:42,972 - app.main - INFO - New device discovered: rearpowerboardmonitor (192.168.101.27)
2025-10-07 18:17:42,978 - app.main - INFO - Saved rearpowerboardmonitor to DeviceDiscovery table
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/metrics HTTP/1.1" 200 OK
INFO:     100.98.57.42:55652 - "GET /api/v1/commands/queue/all?limit=1000 HTTP/1.1" 200 OK
